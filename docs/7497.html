<html>
<head>
<title>Credit Card Validation in Javascript, Ruby, and C</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Javascript、Ruby和C中的信用卡验证</h1>
<blockquote>原文：<a href="https://medium.com/swlh/credit-card-validation-in-javascript-ruby-and-c-4b0a9b245766?source=collection_archive---------9-----------------------#2019-07-03">https://medium.com/swlh/credit-card-validation-in-javascript-ruby-and-c-4b0a9b245766?source=collection_archive---------9-----------------------#2019-07-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6d43306f0bc3cf97d4c2e582ebab4192.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oPOGQVcyhRm6gW32cCrqnQ.jpeg"/></div></div></figure><p id="ed60" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">说到编程，我遇到的每一种语言都有其独特的怪癖和优点。我想通过编写一个信用卡检查器来比较几种常见语言的语法差异。这个应用程序的目标是接受信用卡号码的输入，然后识别信用卡号码在语法上是否有效。这篇文章主要是比较低级语言和高级语言。如果你想看看我是如何实现信用卡检查器的，请在这里查看我在<a class="ae jo" href="https://gist.github.com/joel29dec/62b2b256e4a51353d4014c43504c5ff6" rel="noopener ugc nofollow" target="_blank"> C </a>、<a class="ae jo" href="https://gist.github.com/joel29dec/44fa82a9a522ed27a66a4255f9e0ecd8" rel="noopener ugc nofollow" target="_blank"> Ruby </a>或<a class="ae jo" href="https://gist.github.com/joel29dec/4e95cefe8dfeb112ff64900f76e5bd3d" rel="noopener ugc nofollow" target="_blank"> Javascript </a>中的代码。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jp"><img src="../Images/da18be67b30358ac2a41cef49b43a360.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EcRCOOAokbUd40tJk0Ik4w.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx">Credit Card Payment Method</figcaption></figure><p id="6648" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们大多数人在为网上购物付款时都遇到过这个屏幕。通常在前端，Javascript将处理验证，在调用被发送到服务器之前检查信用卡是否是有效的卡。验证检查的过程基于Hans Peter Luhn创建的校验和算法。下面是对Luhn算法的一个简单分解。</p><h2 id="5a87" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">卢恩校验和算法</h2><blockquote class="kt ku kv"><p id="1df4" class="iq ir kw is b it iu iv iw ix iy iz ja kx jc jd je ky jg jh ji kz jk jl jm jn hb bi translated">从数字的倒数第二个数字开始，每隔一个数字乘以2，然后将这些乘积的数字相加。</p><p id="5054" class="iq ir kw is b it iu iv iw ix iy iz ja kx jc jd je ky jg jh ji kz jk jl jm jn hb bi translated">将总和加到没有乘以2的数字的总和上。</p><p id="609e" class="iq ir kw is b it iu iv iw ix iy iz ja kx jc jd je ky jg jh ji kz jk jl jm jn hb bi translated">如果总数的最后一位是0，则该数字有效！</p><p id="5092" class="iq ir kw is b it iu iv iw ix iy iz ja kx jc jd je ky jg jh ji kz jk jl jm jn hb bi translated">以下面的美国运通号码378734493671000为例。从倒数第二个数字开始，将最后一个数字乘以2。</p><p id="1edd" class="iq ir kw is b it iu iv iw ix iy iz ja kx jc jd je ky jg jh ji kz jk jl jm jn hb bi">7*2 + 7*2 + 4*2 + 9*2 + 6*2 + 1*2 + 0*2</p><p id="00b8" class="iq ir kw is b it iu iv iw ix iy iz ja kx jc jd je ky jg jh ji kz jk jl jm jn hb bi translated">结果是:</p><p id="f665" class="iq ir kw is b it iu iv iw ix iy iz ja kx jc jd je ky jg jh ji kz jk jl jm jn hb bi">14 + 14 + 8 + 18 +12 + 2 + 0</p><p id="cf39" class="iq ir kw is b it iu iv iw ix iy iz ja kx jc jd je ky jg jh ji kz jk jl jm jn hb bi translated">添加产品数字:</p><p id="8401" class="iq ir kw is b it iu iv iw ix iy iz ja kx jc jd je ky jg jh ji kz jk jl jm jn hb bi">1 + 4 + 1 + 4 + 8 + 1 + 8 +1 + 2 + 2 + 0 = 32</p><p id="2f13" class="iq ir kw is b it iu iv iw ix iy iz ja kx jc jd je ky jg jh ji kz jk jl jm jn hb bi translated">最后将没有相乘的数字相加</p><p id="474d" class="iq ir kw is b it iu iv iw ix iy iz ja kx jc jd je ky jg jh ji kz jk jl jm jn hb bi">32 + 3 + 8 + 3 + 4 + 3 + 7 + 0 + 0 = 60</p><p id="086b" class="iq ir kw is b it iu iv iw ix iy iz ja kx jc jd je ky jg jh ji kz jk jl jm jn hb bi translated">校验和60以数字0结尾，因此它是语法上正确的信用卡号</p></blockquote><h2 id="aa27" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">识别信用卡类型</h2><p id="5e17" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">除了校验和之外，信用卡号码也可以识别信用卡公司的类型。Visa卡以数字4开头。万事达卡以数字51、52、53、54或55开头。美国运通以数字34或37开头。</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h1 id="e2a9" class="lm jz hi bd ka ln lo lp ke lq lr ls ki lt lu lv kl lw lx ly ko lz ma mb kr mc bi translated">大局</h1><p id="d6af" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">该解决方案可以分为两部分:</p><ol class=""><li id="601f" class="md me hi is b it iu ix iy jb mf jf mg jj mh jn mi mj mk ml bi translated">检查卡号是否有效。</li><li id="78ed" class="md me hi is b it mm ix mn jb mo jf mp jj mq jn mi mj mk ml bi translated">识别信用卡的类型。</li></ol><p id="4670" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看C语言的语法，并演练一下代码。</p><h1 id="1618" class="lm jz hi bd ka ln mr lp ke lq ms ls ki lt mt lv kl lw mu ly ko lz mv mb kr mc bi translated">卡片长度验证</h1><p id="dbd1" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">为了检查卡号是否有效，我们可以在计算校验和之前进行初步检查。我们知道信用卡号码只能是13、15或16。我们可以用一个简单的while或for循环来实现。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="mw mx l"/></div></figure><p id="cbc0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用户的卡号存储在可变卡号中，并且在每次迭代该号码的长度时，最后一位数字将被移除并计数。然后，将检查数字长度的计数是13、15还是16位。</p><p id="f39b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Javascript和Ruby都有高阶函数，简化了确定变量长度的过程。本质上，在方法或函数长度的掩护下，正在利用类似的过程。</p><h1 id="f796" class="lm jz hi bd ka ln mr lp ke lq ms ls ki lt mt lv kl lw mu ly ko lz mv mb kr mc bi translated">校验和验证</h1><p id="b6c9" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">通过第一个测试后，下一步是检查校验和是否有效。我们将再次看看c语言的语法。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="mw mx l"/></div></figure><p id="58d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在此示例中，声明了数组编号，并通过枚举了卡号，每个数字都保存在数组编号中。使用此方法存储在数组中的数字与原始卡号相反，因为首先删除最后一个数字并将其存储在第一个索引中。</p><p id="83d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">举个例子，信用卡号码是4012 8888 8888 1881。使用取模并除以10的方法存储数组，得到的数组将是[1，8，8，1，8，8，8，8，8，8，2，1，0，4]。</p><p id="f2c1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Javascript中，如果使用高阶函数转换一个数字，在使用高阶函数转换为数组之前，需要先将数字转换为字符串。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="mw mx l"/></div></figure><p id="1af9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可以注意到，当使用Ruby方法转换为数组时，转换为特定数据类型的概念也是类似的。Ruby和Javascript的相似之处在于，它们都要求数据是某种特定的类型，并且通常需要将数据强制转换成可用的类型，然后才能使用更高阶的函数对数据类型进行操作。你可以注意到，在我的Javascript(上图)和Ruby(下图)的例子中，整数被转换成一个字符串，创建成一个数组，然后映射回整数。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="mw mx l"/></div></figure><p id="34fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">C的校验和实现起来更干净，因为操作数据所需的类型转换更少。数组使用简单的for循环和条件语句来验证数字。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="mw mx l"/></div></figure><p id="a86e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上面的C代码中，创建了一个新数组来克隆数字数组，并从倒数第二个值开始将该值乘以2。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="mw mx l"/></div></figure><p id="dc58" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">大部分验证发生在这个嵌套的if语句中。首先确定卡号的长度。然后将数组中的数字相加，并检查这一行中的校验和是否有效。</p><pre class="jq jr js jt fd my mz na nb aw nc bi"><span id="a143" class="jy jz hi mz b fi nd ne l nf ng">sumdigit = (number[i] % 10) + (number[i]/10 % 10);</span></pre><p id="cbb9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过检查数组的第一个和第二个索引来验证卡的类型。在这个例子中，Visa卡以数字4开始。</p><pre class="jq jr js jt fd my mz na nb aw nc bi"><span id="9da8" class="jy jz hi mz b fi nd ne l nf ng">cardarray[12] == 4 &amp;&amp; accumulator % 10 == 0</span></pre><p id="a448" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过使用高阶函数在ruby和javascript中实现验证器使它变得相当冗长。Javascript和Ruby中的C程序完全有可能使用相同的算法。然而，我想利用语言的高阶功能。</p><p id="f583" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了在C中拆分数组，卡号被克隆并使用两个for循环相乘。在Javascript中，我发现可以使用filter函数将初始数组分成两个数组，每隔一个数字，然后在第一个数组上进行简单的映射，使数字加倍。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="mw mx l"/></div></figure><p id="e46c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后对乘以2的数组求和，并使用reduce方法将其添加到未相乘的数组中。如果校验和通过，则对卡阵列的前两位进行切片，以检查卡的类型。卡类型检查的实现类似于C语法。通过使用条件语句，然后对每种类型的卡片数组的数字进行评估。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="mw mx l"/></div></figure><h1 id="6303" class="lm jz hi bd ka ln mr lp ke lq ms ls ki lt mt lv kl lw mu ly ko lz mv mb kr mc bi translated">总结想法</h1><p id="b632" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">这篇文章更多的是对低级语言和高级语言编程差异的自我反思。在尝试创建信用卡检查器时，我发现低级语言的语法在解决问题时更简洁，而使用高级语言需要数据类型转换才能使用高阶函数。</p><p id="c21c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您想创建一个信用卡检查器并测试您自己的代码。我使用Paypal的虚拟信用卡号码来测试校验和以及信用卡类型。如果你想看看，这里有链接。<a class="ae jo" href="https://developer.paypal.com/docs/classic/payflow/payflow-pro/payflow-pro-testing/#credit-card-numbers-for-testing" rel="noopener ugc nofollow" target="_blank">https://developer . paypal . com/docs/classic/pay flow/pay flow-pro/pay flow-pro-testing/#用于测试的信用卡号码</a></p><p id="f349" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我每天都在学习更多的代码。如果你有任何提示或建议，我很乐意听到你的意见。</p></div></div>    
</body>
</html>