<html>
<head>
<title>Deployment Policy to Ensure Zero Downtime — Blue Green Deployment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">确保零停机的部署策略—蓝绿色部署</h1>
<blockquote>原文：<a href="https://medium.com/swlh/blue-green-deployment-with-zero-down-time-222a76ad846f#2019-02-09">https://medium.com/swlh/blue-green-deployment-with-zero-down-time-222a76ad846f#2019-02-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c045fb7486d0071590930eb6f09aa019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FQUR9j3zosqG7da1EszIQA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://www.panaya.com" rel="noopener ugc nofollow" target="_blank">Panaya</a></figcaption></figure><p id="086e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">今天，我将讨论我们如何在生产环境中部署，同时牢记服务的高可用性和零停机时间。我们能用于此目的的技术很少。今天我们将讨论<strong class="ix jt">蓝绿部署</strong>或<strong class="ix jt">红黑部署</strong>。在我看来，简单部署策略是一个花哨的词。</p><h1 id="3c01" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">蓝绿色部署</h1><p id="447c" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">蓝绿色部署的基本思想是您并排运行两个应用程序，一个使用旧版本，另一个使用最新版本。我们已经大致了解了什么是蓝绿色部署，现在让我们深入了解一下蓝绿色部署的流程。</p><p id="60ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设我们有一台运行旧版本的<strong class="ix jt">蓝色</strong>服务器。并希望在生产环境中部署新版本。在我们的生产服务器上创建一个副本绿色服务器()。在一台服务器上部署新的构建，并称之为<strong class="ix jt">绿色服务器。</strong>一旦构建被部署，运行一个冒烟或健全的测试来验证一切工作正常。现在，当您确定新版本(绿色服务器)一切正常时，让我们为用户推出它。现在，我们可以使用两种策略来推出新版本。有一点很重要，那就是你应该让服务器保持运行一段时间，以便在绿色服务器上的新版本出现任何问题的情况下回退到以前的版本。</p><ul class=""><li id="52d2" class="kx ky hi ix b iy iz jc jd jg kz jk la jo lb js lc ld le lf bi translated">将所有用户重定向到新的绿色服务器。</li><li id="1d83" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated">逐步推出新版本，也就是将一定比例的用户重定向到绿色服务器，以确保新版本运行良好。一验证，增加绿色服务器的负载。</li></ul><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/cd07069f82e087425f1a2d995af12e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*R9H3NEUEch8QlIuigzUX0w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Blue Green Deployment Diagram</figcaption></figure><h2 id="6ce1" class="lq jv hi bd jw lr ls lt ka lu lv lw ke jg lx ly ki jk lz ma km jo mb mc kq md bi translated">蓝绿色部署清单</h2><p id="a89c" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">这是您应该维护的蓝绿色部署清单</p><ol class=""><li id="6725" class="kx ky hi ix b iy iz jc jd jg kz jk la jo lb js me ld le lf bi translated">您有两台正在运行服务器(新旧版本)</li><li id="f51a" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js me ld le lf bi translated">在具有新版本的服务器上运行健全性测试</li><li id="6864" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js me ld le lf bi translated">将一些流量路由到新服务器，以便逐步推广。</li><li id="ca9c" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js me ld le lf bi translated">将所有流量路由到新服务器(具有最新版本)</li><li id="89e4" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js me ld le lf bi translated">保留旧服务器一段时间，以便在新的生产版本出现问题时进行回滚。</li></ol><h2 id="b3c0" class="lq jv hi bd jw lr ls lt ka lu lv lw ke jg lx ly ki jk lz ma km jo mb mc kq md bi translated">最后的话</h2><p id="ed86" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">如果我们的服务器托管在AWS上，我们可以使用AWS的托管服务来实现这一点，对于路由，我们可以使用<strong class="ix jt"> Route53 </strong>。但是，如果服务器位于数据中心，并且没有托管服务，那么我们需要制定一些新版本的部署策略。而蓝绿部署策略是个不错的选择。出于路由目的，我们可以利用我们的负载平衡器或任何其他服务。</p><figure class="lm ln lo lp fd ij er es paragraph-image"><a href="https://medium.com/swlh"><div class="er es mf"><img src="../Images/308a8d84fb9b2fab43d66c117fcc4bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YqDjlKFwScoQYQ62DWEdig.png"/></div></a></figure><h2 id="c148" class="lq jv hi bd jw lr ls lt ka lu lv lw ke jg lx ly ki jk lz ma km jo mb mc kq md bi translated">这篇文章发表在<a class="ae iu" href="https://medium.com/swlh" rel="noopener"> The Startup </a>上，这是Medium最大的创业刊物，拥有+421，678名读者。</h2><h2 id="869c" class="lq jv hi bd jw lr ls lt ka lu lv lw ke jg lx ly ki jk lz ma km jo mb mc kq md bi translated">在此订阅接收<a class="ae iu" href="https://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="lm ln lo lp fd ij er es paragraph-image"><a href="https://medium.com/swlh"><div class="er es mf"><img src="../Images/b0164736ea17a63403e660de5dedf91a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ouK9XR4xuNWtCes-TIUNAw.png"/></div></a></figure></div></div>    
</body>
</html>