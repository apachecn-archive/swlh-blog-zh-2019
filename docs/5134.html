<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://medium.com/swlh/rethinking-sharding-and-smart-contracts-for-maximizing-blockchain-throughput-5eaf91bb5781?source=collection_archive---------80-----------------------#2019-06-07">https://medium.com/swlh/rethinking-sharding-and-smart-contracts-for-maximizing-blockchain-throughput-5eaf91bb5781?source=collection_archive---------80-----------------------#2019-06-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/8471e05ff02a3ecc7cac267577c77f1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*70VRP3njoCIQ20e2fMwnjw.jpeg"/></div><figcaption class="hn ho et er es hp hq bd b be z dx">Amdahl’s Law</figcaption></figure><p id="c821" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><strong class="hu iq">重新思考分片和智能合同，以最大限度地提高区块链吞吐量</strong></p><p id="e673" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><em class="ir">-阿姆达尔定律和分片有什么关系？</em></p><p id="96cd" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">(2019年6月21日更新—添加图表)</p><p id="1b7f" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">很多研究都在探讨如何通过分片实现区块链缩放。据我所知，主要概念是支持在不同的碎片上并行执行多个事务，而不损害区块链(包括所有碎片)的不变性和安全性。我所能找到的大多数研究都集中在碎片共识的算法上。虽然所有这些研究看起来都很有前景，但我想从不同的角度来看看分片。</p><p id="9414" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">为了便于讨论，我们假设存在一个一致的分片算法。此外，让我们说这个算法运行在一个开放的无许可区块链上，并且今天是可用的。我的问题是，即使这样，我们是否得到了分片所希望的缩放。为了对此有个感觉，让我们快速看一下阿姆达尔定律<a class="ae is" href="#_ftn1" rel="noopener ugc nofollow">【1】</a>:</p><p id="b2a4" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><a class="ae is" href="#_ftnref1" rel="noopener ugc nofollow">【1】</a><a class="ae is" href="https://en.wikipedia.org/wiki/Amdahl%27s_law" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Amdahl%27s_law</a></p><figure class="it iu iv iw fd hk er es paragraph-image"><div class="er es hg"><img src="../Images/51681ad201a7fb59fc069dfb2ea5dc09.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*ilaLAV6m_aPlkA98U6aUHQ.png"/></div></figure><p id="fc14" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">这表明整个任务执行的理论加速随着系统资源的改善而增加，并且不管改善的幅度如何，理论加速总是受到不能从改善中受益的任务部分的限制。<a class="ae is" href="#_ftn1" rel="noopener ugc nofollow">【1】</a>这实质上是说，一旦所有可并行化部分最大化，系统的吞吐量就被限制为串行部分的吞吐量。</p><p id="ef51" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">对于区块链分片，我认为这意味着吞吐量的潜在增长目前受限于可以在不同分片上同时执行的事务数量。也就是说，如果一个碎片上的事务需要来自另一个碎片的数据，它必须同步来自另一个碎片的数据传输。这是序列化的一个要点，根据阿姆达尔定律，给定一个大的碎片池将决定吞吐量。</p><p id="d8ee" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><strong class="hu iq">个人原生硬币交易</strong></p><p id="fa34" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">两个账户之间的交易明确限于仅在账户之间转移硬币余额，例如在两个账户之间发送硬币，不需要来自任何其他账户的数据。因此，如果两个帐户的数据在一个特定的shard上可用，该事务可以与其他帐户上的其他事务异步执行。这与碎片的数量和帐户对之间不相交交易的数量成比例。随着账户数量的增长，分割这种独立交易的机会也会增加。在极限情况下，吞吐量由执行单个事务所花费的时间决定，而不管在任何给定的时间点有多少事务正在被执行。这正是我们希望提高区块链吞吐量的情况。</p><p id="5aa1" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><strong class="hu iq">智能分片合约</strong></p><p id="dcaa" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">智能合约的情况并不那么好。智能合同作为单个总帐科目在区块链上实施，其数据状态与程序代码相关联。每个事务都运行更改数据状态的代码。每次更改都记录在区块链上，并用代表状态的哈希进行验证。为了维护区块链的确定性的一致状态，每个智能合约一次只能在一个分片上执行，除非智能合约帐户本身的状态可以被分片。通常，这使得智能合约帐户执行成为向智能合约发送交易的所有帐户的限制因素。由于智能合约用于令牌化，正如阿姆达尔定律所预测的那样，随着给定令牌在流通中的增加，无论存在多少碎片，其智能合约都很可能成为吞吐量的瓶颈。下图描述了智能合同序列化:</p><figure class="it iu iv iw fd hk er es paragraph-image"><div class="er es ix"><img src="../Images/545bf58843105f44ca41bc6a5a9792c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*VJBMtJhr_QUgflprtJlcDA.png"/></div></figure><p id="b18a" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">对于智能合约的当前实现模型，我认为只有两种可能的方式来扩展分片:</p><p id="885b" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">使用在碎片上分离的多个智能合约</p><p id="ca88" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">使用确定性多线程智能契约(又名SIMD)</p><p id="1625" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">多个智能合约可以利用分片。例如，如果代表一个令牌的每个智能合约被分配给一个单独的碎片，则给定令牌的事务不会影响其他令牌的事务。尽管每个令牌的事务都受限于特定碎片上智能合约的吞吐量，但是随着令牌数量的增加，碎片的数量也会随之线性增加。这并没有解决单个智能合约的吞吐量问题，但它是对没有分片的单个区块链上的所有智能合约的改进。即使使用这种方法，如果需要在碎片之间共享的用户帐户的任何状态(例如，支付交易的原生硬币)，也会出现问题。</p><p id="db05" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">超级计算中的一种称为向量化的技术使程序能够并行执行其代码部分。这被称为单指令多数据(“SIMD”)。为SIMD编写的程序是确定性的。本质上，今天作为通用图形处理器单元(“GPGPU”)的SIMD机器在一系列处理器之间共享数据。这对于某些类别的应用程序非常有效，例如图形的矩阵运算等。</p><p id="9826" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">这种技术理论上可以应用于区块链智能合约。也就是说，可以显式地编写一个智能协定，以某种方式支持事务的并行执行。我不知道这将如何实现。也许区块链研究公司会在这方面有所创新。然而，即使有了这样的解决方案，编写一个支持SIMD的智能契约也会变得非常复杂。</p><p id="19bb" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">多重智能合约和SIMD智能合约都不是理想的解决方案，尽管两者都可能提供一些扩展的机会。</p><p id="bbcf" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><strong class="hu iq">智能对象资产有助于实现分片</strong></p><p id="c38d" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">智能契约分片的限制点是状态分片和代码执行分片。如果有一种方法可以避免事务在单个智能协定状态和代码执行上序列化，分片就可以提高吞吐量。换句话说，如果有一种多指令多数据(“MIMD”)执行的方法，区块链分片的机会将大大提高。</p><p id="237e" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">正如“重新思考区块链账户概念”<a class="ae is" href="#_ftn2" rel="noopener ugc nofollow">【2】</a>中所述，如果每个用户账户都有自己的状态，而不是使用单独的智能合约，那么每个用户账户都可以包含代表资产的对象，无论是令牌还是其他类型的实体。如“使用数据网格区块链可扩展区块链对象模型的可扩展智能对象资产、智能对象资产所有权和部分智能对象资产所有权<strong class="hu iq"/><a class="ae is" href="#_ftn3" rel="noopener ugc nofollow">【3】</a>中所述，XSOA和对XSOA的引用可用于在账户之间转移所有权，直接在账户状态之间进行交易。</p><p id="f5a5" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">例如，给定两组交易，其中每笔交易都是在不同账户之间进行的，即:一笔交易是从账户A到账户B；并且另一个交易是在账户C和账户D之间进行的，那么这些交易可以同时在不同的分片上执行。此外，因为XSOA的代码独立于任何账户，并且对于每个交易可能是不同的代码，所以我们可以实现MIMD模型的分片。也就是说，每个分片上有不同的代码，每个分片上有不同的数据。下图描述了智能对象资产并行化:</p><figure class="it iu iv iw fd hk er es paragraph-image"><div class="er es ix"><img src="../Images/084f4be0095631ad0fe86ecadc315f73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*RaHHibFab3iWcCpjSoq2qg.png"/></div></figure><p id="bc0e" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">这里规模的限制点是不相交的账户集之间可以同时发生的交易数量。我们预计，随着账户数量的增长，任何交易组内不相交账户集的机会也会增加，这反过来会导致切分机会的增加。</p><p id="f6d8" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><strong class="hu iq">结论</strong></p><p id="ca6e" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">以下是串行和并行概念的对比:</p><figure class="it iu iv iw fd hk er es paragraph-image"><div class="er es ix"><img src="../Images/7aa86c68f29ea11adafc652fe62a17f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Z4c4cPjvPTTS45n57aKIhQ.png"/></div></figure><p id="c3f6" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">作为给定的分片共识算法的可用性，一个突出的问题是如何利用这种技术。智能合约固有地序列化事务，并且不同于复杂的SIMD类型解决方案，仅通过使用多个单独的隔离智能合约来提供扩展。即便如此，每个智能合约的吞吐量也仅限于单个碎片的吞吐量。通过重新考虑用户帐户以包括状态信息，并使用XBOM模型，DataGrid Blockchain提供了一种解决方案，可根据帐户数量和帐户之间的不相交交易进行扩展。除了支持继承和实时代码重用，我们相信这是解决区块链伸缩问题的一个重要方案。</p><p id="090d" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><a class="ae is" href="#_ftnref1" rel="noopener ugc nofollow">【1】</a>同上</p><p id="0d2d" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><a class="ae is" href="#_ftnref2" rel="noopener ugc nofollow">【2】</a><a class="ae is" rel="noopener" href="/@dbeberman/rethinking-the-blockchain-account-concept-6c94748f8021">https://medium . com/@ db eberman/re thinking-the-区块链-account-concept-6c 94748 f 8021</a></p><p id="c6d0" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><a class="ae is" href="#_ftnref3" rel="noopener ugc nofollow">【3】</a><a class="ae is" rel="noopener" href="/@dbeberman/extensible-smart-object-assets-smart-object-asset-ownership-and-fractional-smart-object-asset-995c259a8508">https://medium . com/@ db eberman/extensible-smart-object-assets-smart-object-assets-ownership-and-fractional-smart-object-asset-995 c259 a 8508</a></p><p id="4674" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">DataGrid Blockchaintm、DGBtm、DataGrid Tokentm、DGTtm、Extensible block chain Object model TM、XBOMtm、Extensible Smart Object Assettm、XSOAtm、Smart Objecttm、Extensible Signature Objecttm、XSIGtm是Prasaga，LLC的商标。保留所有权利。www.prasaga.com·info@prasaga.com</p></div></div>    
</body>
</html>