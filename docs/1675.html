<html>
<head>
<title>Navigate the deepest parts of JavaScript- Closures [3/10]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">浏览JavaScript的最深处——闭包[3/10]</h1>
<blockquote>原文：<a href="https://medium.com/swlh/navigate-the-deepest-parts-of-javascript-closures-3-10-bf1974dbfaa9#2019-03-15">https://medium.com/swlh/navigate-the-deepest-parts-of-javascript-closures-3-10-bf1974dbfaa9#2019-03-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d724e746b693df38bb218e26896fa7a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D7lNKf02GZF_G0KjSlVy8g.jpeg"/></div></div></figure><p id="4683" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意:这是我正在进行的关于复杂JavaScript主题的系列文章。请在这里阅读本系列以前的文章:</p><div class="jo jp ez fb jq jr"><a rel="noopener follow" target="_blank" href="/swlh/navigate-the-deepest-parts-of-javascript-closures-1-10-a4214680b6f5"><div class="js ab dw"><div class="jt ab ju cl cj jv"><h2 class="hj b fi z dy jw ea eb jx ed ef hh bi translated">浏览JavaScript的最深处——闭包[1/10]</h2><div class="jy l"><h3 class="bd b fi z dy jw ea eb jx ed ef dx translated">作为初学者，我是如何破解困难的JS概念的。</h3></div><div class="jz l"><p class="bd b fp z dy jw ea eb jx ed ef dx translated">medium.com</p></div></div><div class="ka l"><div class="kb l kc kd ke ka kf io jr"/></div></div></a></div><div class="jo jp ez fb jq jr"><a rel="noopener follow" target="_blank" href="/swlh/navigate-the-deepest-parts-of-javascript-closures-2-10-b7deac267d1"><div class="js ab dw"><div class="jt ab ju cl cj jv"><h2 class="hj b fi z dy jw ea eb jx ed ef hh bi translated">浏览JavaScript- Closures的最深处[2/10]。</h2><div class="jy l"><h3 class="bd b fi z dy jw ea eb jx ed ef dx translated">这是一个正在进行的关于中间JavaScript方法的系列。如果你没有看过我的第一篇博客，请回头看看…</h3></div><div class="jz l"><p class="bd b fp z dy jw ea eb jx ed ef dx translated">medium.com</p></div></div><div class="ka l"><div class="kg l kc kd ke ka kf io jr"/></div></div></a></div><p id="f820" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">既然您已经接受了闭包是什么，并且已经看到了如何使用闭包在我们的代码中实现某些行为的例子，那么让我们更深入地研究如何使用闭包来实现<strong class="is kh"> <em class="ki">模块设计模式。</em>T3】</strong></p><p id="4211" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">考虑下面的例子。你在做一个网站的导航。您直接处理DOM来向左或向右滑动当前页面。你想出了下面的代码。代码是不言自明的。</p><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/92df41a0606d6b11e8352b326eed1858.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EQrYqPK5c9aDWE3sGmeZdA.png"/></div></div></figure><p id="ae92" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它有两个功能，<em class="ki">前进()</em>和<em class="ki">后退()</em>。向前功能向前滑动页面，向后功能向后滑动页面。在做任何事情之前，forward函数会检查我们是否已经到了最后一页。如果是的话，那就意味着我们没有更多的页面可以前进了。所以函数什么都不做就返回。同样，backward函数检查我们是否已经在第一页了。如果是的话，你知道那意味着什么。</p><p id="6357" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，如您所见，上面的代码存在许多问题。首先，假设有两个<strong class="is kh">全局函数</strong>。可以肯定的是，随着代码库的增长，这种混乱会越来越多，你很快就会忘记在全局名称空间中声明了什么。想象一下，如果在其他页面中，您不小心声明了另一个同名的函数，那该怎么办。因为函数“forward”适用于页面导航，所以同名的forward()也适用于另一个在页面内移动滑块的函数是有意义的，也许？然后你将不得不保存所有全球事物的索引；相信我，这不是你应该做的事。然后你应该为其他函数想出类似“<em class="ki"> moveForward() </em>”或“<em class="ki"> next() </em>”的替代方法；过一段时间，你的代码库就变成了一个普通的变种。随着代码库的增长，您很快就会失去对它的跟踪。</p><p id="ef87" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你应该做的是考虑最终维护你的代码的人。你已经知道俗话说得好。“总是认为最终维护你的代码的人是一个知道你住在哪里的暴力精神病患者。”</p><p id="f0a0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您现在需要做的是，将两个全局函数从全局名称空间移动到它们自己的对象中。</p><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/782d26bdae6a5227786a5f04639aaeb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kcA6r3sPQ8N0q5M4OuVClg.png"/></div></div></figure><p id="e8e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好多了。现在，您可以将您的函数称为<em class="ki"> mainNavigation.forward() </em>，这确实很有意义。尽管如此，仍有两个全局变量currentIndex和maxIndex跟踪当前页面的索引和总页数。这两个也“污染”了全局名称空间；因为你最终可能会用相同的名字声明其他变量来跟踪代码中其他地方的东西，这样你的代码就会逐渐变成意大利面条。因此，进行以下操作是有意义的:</p><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/1b00818d4a8ad0d0e0399e4bcf0a7e93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qwYCZ22s5HArNl7RdGDGvQ.png"/></div></div></figure><h2 id="dd4b" class="kq kr hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated">你刚刚做的是；把所有关于主导航的东西都移到了它自己的函数表达式中；在这种情况下，它是一个立即调用的函数表达式，或IEFE。</h2><p id="8e22" class="pw-post-body-paragraph iq ir hi is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hb bi translated">现在它们被包装得很好很紧密，变量不会污染全局名称空间。</p><blockquote class="lq lr ls"><p id="0f98" class="iq ir ki is b it iu iv iw ix iy iz ja lt jc jd je lu jg jh ji lv jk jl jm jn hb bi translated">但是，他们现在是否被紧紧地包裹在生活中？现在没人能找到他们了！没有对它们的外部引用，所以它们永远不会被访问或使用。我们现在要干嘛？</p></blockquote><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ebd805f45a912b3eabe1f134102d8774.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d-uxz6DBOzRiSGHsvCi-2g.jpeg"/></div></div></figure><h2 id="0e44" class="kq kr hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated">我们需要创建对这些函数的外部引用，这样我们就可以在外部使用这些函数。</h2><p id="38d3" class="pw-post-body-paragraph iq ir hi is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hb bi translated">我们如何做到这一点？</p><p id="ccce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">是的。你说得太对了。关闭以拯救世界。</p><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/7404df0da6ddafe3af99287ba61858a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7enf-ZCkGu6rC2_LUvHQRw.png"/></div></div></figure><p id="63fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们刚才所做的是，创建了一个内部块，它封装了前进和后退函数，并将它们返回给调用变量；在这种情况下，<em class="ki">主导航</em>。所以变量<em class="ki"> mainNavigation </em>现在可以用来控制导航的各个方面。变量<em class="ki"> currentIndex </em>和<em class="ki"> maxIndex </em>现在在这些函数的闭包范围内；并且即使IEFE存在也可以被跟踪。</p><p id="8829" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，仔细看。我们在这里所做的是模仿阶级行为。变量<em class="ki"> currentIndex </em>和<em class="ki"> maxIndex </em>现在是私有变量，只能通过类的成员函数访问。我们有两个公共方法，<em class="ki"> forward() </em>和<em class="ki"> backward() </em>，可以在任何地方使用；和两个私有变量。</p><h2 id="81fd" class="kq kr hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated">这被称为模块模式。</h2><p id="e580" class="pw-post-body-paragraph iq ir hi is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hb bi translated">现在，您已经保持了代码的整洁和可维护性。你封装了你的脚本的不同部分，这些部分彼此之间没有太多的联系。</p><h2 id="2be6" class="kq kr hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated">这样，当你的代码库增长时，你就有机会了。</h2><p id="6d60" class="pw-post-body-paragraph iq ir hi is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hb bi translated">你好世界。这些是我希望在我开始学习JavaScript时就拥有的文章和信息。这些灵感来自不同的来源，在不同的时期积累。关注我了解更多信息。</p><figure class="kk kl km kn fd ij er es paragraph-image"><a href="https://medium.com/swlh"><div class="er es lx"><img src="../Images/308a8d84fb9b2fab43d66c117fcc4bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YqDjlKFwScoQYQ62DWEdig.png"/></div></a></figure><h2 id="c148" class="kq kr hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated">这篇文章发表在<a class="ae ly" href="https://medium.com/swlh" rel="noopener"> The Startup </a>上，这是Medium最大的创业刊物，拥有+435，678名读者。</h2><h2 id="869c" class="kq kr hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated">在这里订阅接收<a class="ae ly" href="https://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="kk kl km kn fd ij er es paragraph-image"><a href="https://medium.com/swlh"><div class="er es lx"><img src="../Images/b0164736ea17a63403e660de5dedf91a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ouK9XR4xuNWtCes-TIUNAw.png"/></div></a></figure></div></div>    
</body>
</html>