<html>
<head>
<title>Deploying a Java package to AWS Lambda with Maven</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Maven将Java包部署到AWS Lambda</h1>
<blockquote>原文：<a href="https://medium.com/swlh/deploying-a-java-package-to-aws-lambda-with-maven-8ecb25ce6443?source=collection_archive---------6-----------------------#2019-06-25">https://medium.com/swlh/deploying-a-java-package-to-aws-lambda-with-maven-8ecb25ce6443?source=collection_archive---------6-----------------------#2019-06-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/2be6a43000dfd14f0f9697d612555104.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*ng59GkbQ2G1l4PQCGh-udg.png"/></div><figcaption class="im in et er es io ip bd b be z dx">Picture by: Valve Software [CC BY-SA 4.0 (<a class="ae iq" href="https://creativecommons.org/licenses/by-sa/4.0" rel="noopener ugc nofollow" target="_blank">https://creativecommons.org/licenses/by-sa/4.0</a>)]</figcaption></figure><p id="33b8" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">将代码部署到AWS Lambda可能是一件轻而易举的事情，尤其是当您使用的语言可以在Lambda的内部文本编辑器中编写时，比如Node.js或Python，而不是Java。</p><p id="8f25" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">为了在Java中将一个函数部署到Lambda，首先需要将它打包到一个jar或zip文件中。尽管这看起来是一个简单的任务，但对于缺乏Maven和Gradle经验的Java开发人员来说，这可能是一个挑战。</p><p id="17ef" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，这很好。然而，问题是，为了让它在适当的。拉链还是。jar格式，需要使用包管理器，如<a class="ae iq" href="https://maven.apache.org/index.html" rel="noopener ugc nofollow" target="_blank"> Maven </a>或<a class="ae iq" href="https://gradle.org/" rel="noopener ugc nofollow" target="_blank"> Gradle </a>。(利用<a class="ae iq" href="https://aws.amazon.com/tools/" rel="noopener ugc nofollow" target="_blank"> AWS SDK </a>的Eclipse 插件<a class="ae iq" href="https://docs.aws.amazon.com/lambda/latest/dg/java-author-using-eclipse-sdk-plugin.html" rel="noopener ugc nofollow" target="_blank">是另一种选择)。</a></p><p id="ac46" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在本教程中，我将使用命令行引导您完成Maven的整个过程。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="85b2" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it jw">入门:</strong></p><ul class=""><li id="c6f2" class="jx jy hi it b iu iv iy iz jc jz jg ka jk kb jo kc kd ke kf bi translated">安装所需的软件</li><li id="66f0" class="jx jy hi it b iu kg iy kh jc ki jg kj jk kk jo kc kd ke kf bi translated">创建新项目来测试Lambda</li></ul><p id="f178" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it jw">为Maven配置项目:</strong></p><ul class=""><li id="7ea8" class="jx jy hi it b iu iv iy iz jc jz jg ka jk kb jo kc kd ke kf bi translated">确保项目可以用Maven编译</li><li id="de79" class="jx jy hi it b iu kg iy kh jc ki jg kj jk kk jo kc kd ke kf bi translated">为Maven添加AWS依赖项</li></ul><p id="c93b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it jw">整理完毕</strong></p><ul class=""><li id="f934" class="jx jy hi it b iu iv iy iz jc jz jg ka jk kb jo kc kd ke kf bi translated">编译项目</li><li id="78df" class="jx jy hi it b iu kg iy kh jc ki jg kj jk kk jo kc kd ke kf bi translated">将项目上传到Lambda</li></ul></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="73cd" class="kl km hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">入门指南</h1><p id="21f6" class="pw-post-body-paragraph ir is hi it b iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo hb bi translated">在我们需要将我们的包部署到lambda之前，我们首先需要确保我们已经安装了maven，并且我们有一个可以与AWS Lambda接口的Java项目。</p><h2 id="4af9" class="lo km hi bd kn lp lq lr kr ls lt lu kv jc lv lw kz jg lx ly ld jk lz ma lh mb bi translated">安装所需的软件</h2><p id="e8de" class="pw-post-body-paragraph ir is hi it b iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo hb bi translated">在你做任何事情之前，<a class="ae iq" href="https://maven.apache.org/download.cgi" rel="noopener ugc nofollow" target="_blank">在你的电脑上安装maven </a>。一旦你安装好了，进入你的终端，运行<code class="du mc md me mf b">mvn --version</code>来检查它的配置是否正确</p><p id="e016" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">您应该会得到类似于以下内容的响应:</p><pre class="mg mh mi mj fd mk mf ml mm aw mn bi"><span id="6906" class="lo km hi mf b fi mo mp l mq mr">Apache Maven 3.6.0 (97c98ec64a1fdfee7767ce5...; 2018-10-24T14:41:47-04:00)</span></pre></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h2 id="a48a" class="lo km hi bd kn lp lq lr kr ls lt lu kv jc lv lw kz jg lx ly ld jk lz ma lh mb bi translated">创建新项目来测试Lambda</h2><p id="b041" class="pw-post-body-paragraph ir is hi it b iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo hb bi translated">在您最喜欢的Java IDE(我的是<a class="ae iq" href="https://www.jetbrains.com/idea/" rel="noopener ugc nofollow" target="_blank"> Intellij </a>)中，创建一个新的<em class="ms"> maven </em>项目。在您的<em class="ms"> src </em>目录中，创建一个名为<em class="ms"> example的包。然后在<em class="ms">示例</em>中，创建一个名为<em class="ms"> Hello的新Java类。</em>删除自动生成的代码，添加以下代码(取自<a class="ae iq" href="https://docs.aws.amazon.com/lambda/latest/dg/java-handler-io-type-stream.html" rel="noopener ugc nofollow" target="_blank"> AWS文档</a>):</em></p><pre class="mg mh mi mj fd mk mf ml mm aw mn bi"><span id="fd15" class="lo km hi mf b fi mo mp l mq mr">package example;</span><span id="1456" class="lo km hi mf b fi mt mp l mq mr">import java.io.InputStream;<br/>import java.io.OutputStream;<br/>import com.amazonaws.services.lambda.runtime.RequestStreamHandler;<br/>import com.amazonaws.services.lambda.runtime.Context;</span><span id="7205" class="lo km hi mf b fi mt mp l mq mr">public class Hello implements RequestStreamHandler{<br/>    public void handleRequest(InputStream inputStream, OutputStream outputStream, Context context) throws IOException {<br/>        int letter;<br/>        while((letter = inputStream.read()) != -1)<br/>        {<br/>            outputStream.write(Character.toUpperCase(letter));<br/>        }<br/>    }<br/>}</span></pre><p id="fded" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在本教程中，我将使用<a class="ae iq" href="https://git-scm.com/downloads" rel="noopener ugc nofollow" target="_blank"> Git Bash </a> for Windows。然而，任何终端都可以工作。打开终端后，使用<code class="du mc md me mf b">cd &lt;path to directory&gt;</code>导航到想要在Lambda上部署的项目的根目录。</p><p id="6c87" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it jw">注意:</strong>如果mvn isntall说您指向了错误的路径，请将JAVA_HOME环境系统变量设置为程序文件中的jdk</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="7f32" class="kl km hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">为Maven配置项目</h1><p id="c7ea" class="pw-post-body-paragraph ir is hi it b iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo hb bi translated">如果您最初创建的项目是一个maven项目，那么您应该已经准备好编译它并将其升级到AWS Lambda！</p><p id="7b89" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">否则，按照下面的步骤将其配置为一个。</p><h2 id="7ad0" class="lo km hi bd kn lp lq lr kr ls lt lu kv jc lv lw kz jg lx ly ld jk lz ma lh mb bi translated">确保项目可以用Maven编译</h2><p id="6f9f" class="pw-post-body-paragraph ir is hi it b iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo hb bi translated">首先，您需要在项目的主目录中添加一个pom.xml(项目对象模型)。pom.xml包含项目的元数据，比如什么类应该被视为项目入口点，以及项目需要什么依赖项。</p><p id="e138" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">你可以在maven网站上的这里找到pom.xml示例的列表<a class="ae iq" href="https://maven.apache.org/guides/introduction/introduction-to-the-pom.html" rel="noopener ugc nofollow" target="_blank">。您还可以使用下面的代码片段作为模板来构建pom.xml文件。</a></p><pre class="mg mh mi mj fd mk mf ml mm aw mn bi"><span id="6819" class="lo km hi mf b fi mo mp l mq mr">&lt;project&gt;<br/>  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/>  &lt;groupId&gt;com.mycompany.app&lt;/groupId&gt;<br/>  &lt;artifactId&gt;my-app&lt;/artifactId&gt;<br/>  &lt;version&gt;1&lt;/version&gt;<br/>&lt;/project&gt;</span></pre><p id="735b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">要使用命令行添加该文件，请导航到您的主项目目录，即包含<em class="ms"> src </em>文件夹的目录，并运行<code class="du mc md me mf b">touch pom.xml</code></p><p id="8463" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这将创建一个pom.xml文件。接下来，键入<code class="du mc md me mf b">vim pom.xml</code>在vim编辑器中打开文件。按<code class="du mc md me mf b">i</code>键进入<em class="ms">插入</em>模式，同时按&lt;shift&gt;T29】insert&gt;将上述代码从剪贴板中粘贴出来。</p><p id="8101" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">按<escape>退出vim的插入模式，然后输入<code class="du mc md me mf b">wq!</code>并按&lt;输入&gt;保存并退出Vim</escape></p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h2 id="5cb2" class="lo km hi bd kn lp lq lr kr ls lt lu kv jc lv lw kz jg lx ly ld jk lz ma lh mb bi translated">为Maven添加AWS依赖项</h2><p id="3b7b" class="pw-post-body-paragraph ir is hi it b iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo hb bi translated">为了与AWS lambda接口，您需要在代码中导入<em class="ms"> RequestStreamHandler </em>。</p><p id="1a1f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">使用Maven，任何导入都需要在pom.xml文件中指定，在这里它们被称为<em class="ms">依赖项。</em></p><p id="ddee" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">对于<em class="ms"> RequestStreamHandler </em>您需要的特定依赖关系是<em class="ms"> aws-lambda-java-core </em>依赖关系。要将它添加到pom.xml文件中，请再次在Vim中打开它，并将下面的代码添加到<code class="du mc md me mf b">&lt;project&gt;...&lt;/project&gt;</code>标记中。</p><pre class="mg mh mi mj fd mk mf ml mm aw mn bi"><span id="6ca2" class="lo km hi mf b fi mo mp l mq mr">&lt;dependencies&gt;    <br/>    &lt;dependency&gt;<br/>        &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;<br/>        &lt;artifactId&gt;aws-lambda-java-core&lt;/artifactId&gt;<br/>        &lt;version&gt;1.0.0&lt;/version&gt;<br/>    &lt;/dependency&gt;<br/>&lt;/dependencies&gt;</span></pre><p id="d9bf" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">单独的依赖关系包含在<code class="du mc md me mf b">&lt;dependency&gt;</code>标签中，而那些依赖关系包含在<code class="du mc md me mf b">&lt;dependencies&gt;</code>标签中。</p><p id="f63b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">当使用maven编译项目时，这些依赖项列表将用于从在线存储库中下载相应的源代码到您的项目中。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="efba" class="kl km hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">收尾工作</h1><p id="1601" class="pw-post-body-paragraph ir is hi it b iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo hb bi translated">一旦你建立了一个项目并准备好与AWS Lambda集成，就该用Maven编译它了！</p><h2 id="b771" class="lo km hi bd kn lp lq lr kr ls lt lu kv jc lv lw kz jg lx ly ld jk lz ma lh mb bi translated">编译您的项目</h2><p id="6bec" class="pw-post-body-paragraph ir is hi it b iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo hb bi translated">在您的终端中，导航到主<em class="ms">项目</em>目录。这个目录包含您的pom.xml和<em class="ms"> src </em>目录。</p><p id="7436" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">运行<code class="du mc md me mf b">mvn install</code></p><p id="026d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">如果您的代码编译成功，您应该会看到这样的输出(<strong class="it jw">图1 </strong>)以及<em class="ms">构建成功</em>:</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/4dbb3d8b61617975f0dcface31d68d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*OAiw3jnBfNCXFW-f2NxT8A.png"/></div><figcaption class="im in et er es io ip bd b be z dx"><strong class="bd mv">Fig. 1. </strong>Maven built successfully (Picture by: Michael Madden)</figcaption></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h2 id="ce50" class="lo km hi bd kn lp lq lr kr ls lt lu kv jc lv lw kz jg lx ly ld jk lz ma lh mb bi translated">将项目上传到Lambda</h2><p id="17fd" class="pw-post-body-paragraph ir is hi it b iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo hb bi translated">一旦编译成功，就该上传。jar文件maven已创建。</p><p id="6e7a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这个文件将位于maven创建的<em class="ms">目标</em>目录中。该文件的路径将是</p><pre class="mg mh mi mj fd mk mf ml mm aw mn bi"><span id="166d" class="lo km hi mf b fi mo mp l mq mr">&lt;Your Project directory&gt;/target/&lt;NameOfProject-SNAPSHOT.jar&gt;</span></pre><p id="5032" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在AWS中打开Lambda控制台，转到要上传该项目的函数，选择<em class="ms"> upload zip或。jar文件如</em> <strong class="it jw"> <em class="ms">图2 </em> </strong> <em class="ms">所示。</em></p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="er es mw"><img src="../Images/be86cecbee78e36412344e7efd72bd27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*27g1jPVjNJOEsuPd0xv-Qg.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx"><strong class="bd mv">Fig. 2. </strong>Upload the .jar file (Picture by: Michael Madden)</figcaption></figure><p id="c027" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">恭喜你！您已经成功地将Java包部署到AWS Lambda了！</p></div></div>    
</body>
</html>