<html>
<head>
<title>Simple MVP Design Pattern in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift中的简单MVP设计模式</h1>
<blockquote>原文：<a href="https://medium.com/swlh/simple-mvp-design-pattern-in-swift-3655811e0415?source=collection_archive---------1-----------------------#2019-06-28">https://medium.com/swlh/simple-mvp-design-pattern-in-swift-3655811e0415?source=collection_archive---------1-----------------------#2019-06-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/8d785a683c2beb9d4389b81153a5c724.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Yf9H3RWc9pdcnxxco_dTqQ.png"/></div></figure><p id="821f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">作为我学习的一部分，我一直在研究Swift中不同的设计模式和架构。</p><p id="fa2c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">大多数人在开始学习Swift时，会熟悉MVC(模型视图控制器)模型，但这可能会很快导致“大量”View Controller文件，并且在对应用程序内的逻辑执行单元测试时可能会受到限制。</p><p id="2d54" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">“大规模”风险投资问题的替代方案是实现MVP模型。MVP代表Model View Presenter，其核心是一种从ViewController文件中移走大部分逻辑并代之以对Presenter的调用的有效方法。这意味着您的演示者文件中的所有内容都是可测试的，并且易于访问和阅读。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div class="er es jk"><img src="../Images/36eaa2f25b71a3894a44ba9840ca3a80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*sGI2Yl9n2YQLImr3RdndLw.png"/></div></figure><p id="276c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这个简单、基本的应用程序将帮助我们使用MVP模型进行设置。该应用程序的功能很小，基本上我们有一个按钮和一个标签，当按钮点击5次，标签会改变(以及视图的背景颜色)。</p><p id="5e5b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在一个基本的单视图项目中，我将ViewController.swift文件设置为如下所示:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="6a13" class="ju jv hi jq b fi jw jx l jy jz"><strong class="jq ka">import</strong> UIKit</span><span id="0fa8" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">class</strong> ViewController: UIViewController {<br/></span><span id="e8c4" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">lazy</strong> <strong class="jq ka">var</strong> presenter = Presenter(with: <strong class="jq ka">self</strong>)</span><span id="ddac" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">@IBOutlet</strong> <strong class="jq ka">weak</strong> <strong class="jq ka">var</strong> changeTextLabel: UILabel!</span><span id="4ef2" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">override</strong> <strong class="jq ka">func</strong> viewDidLoad() {</span><span id="83ad" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">    super</strong>.viewDidLoad()</span><span id="e765" class="ju jv hi jq b fi kb jx l jy jz">}</span><span id="5811" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">@IBAction</strong> <strong class="jq ka">func</strong> tapMeButton(<strong class="jq ka">_</strong> sender: <strong class="jq ka">Any</strong>) {</span><span id="e776" class="ju jv hi jq b fi kb jx l jy jz">    presenter.buttonTapped()</span><span id="94f1" class="ju jv hi jq b fi kb jx l jy jz">}</span><span id="a925" class="ju jv hi jq b fi kb jx l jy jz">}</span></pre><p id="dca2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">就是这样！我们给ViewController访问一个presenter的权限，一旦视图被加载，我们就将一个我们的“<strong class="io ka"> self </strong>的引用传递给presenter。当点击<strong class="io ka">按钮</strong>时，我们会给演示者打电话说“嘿！我被窃听了！我该怎么办？”</p><p id="9d68" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io ka">接下来，</strong>到Presenter.swift文件:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="f2ba" class="ju jv hi jq b fi jw jx l jy jz"><strong class="jq ka">import</strong> Foundation</span><span id="5d2c" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">protocol</strong> PresenterView: class {</span><span id="5b93" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">    func</strong> updateLabel()</span><span id="e3ee" class="ju jv hi jq b fi kb jx l jy jz">}</span><span id="3e4d" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">class</strong> Presenter {</span><span id="1cdc" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">weak</strong> <strong class="jq ka">var</strong> view: PresenterView?</span><span id="1a11" class="ju jv hi jq b fi kb jx l jy jz"><em class="kc">// Pass something that conforms to PresenterView</em></span><span id="7a3f" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">init</strong>(with view: PresenterView) {</span><span id="ab2d" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">    self</strong>.view = view</span><span id="b588" class="ju jv hi jq b fi kb jx l jy jz">}</span><span id="1121" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">var</strong> timesTapped = 0</span><span id="4f75" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">func</strong> buttonTapped() {</span><span id="d192" class="ju jv hi jq b fi kb jx l jy jz">    timesTapped += 1</span><span id="656a" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">    if</strong> timesTapped &gt;= 5 {</span><span id="0d2f" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">    self</strong>.view?.updateLabel()</span><span id="d77b" class="ju jv hi jq b fi kb jx l jy jz">}</span><span id="7616" class="ju jv hi jq b fi kb jx l jy jz">}</span><span id="418a" class="ju jv hi jq b fi kb jx l jy jz">}</span></pre><p id="661b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里我写了一个<strong class="io ka"> PresenterView </strong>协议方法，当订阅它时需要一个updateLabel()函数，我们稍后将在ViewController上订阅它，在这里我们将告诉ViewController向用户显示什么。</p><p id="9a01" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">接下来，在<strong class="io ka"> Presenter </strong>类中，我们设置一个可选视图，然后用<strong class="io ka">Presenter view</strong>playing<strong class="io ka"/>对其进行初始化。一旦我们订阅了协议，视图的滚动将在ViewController上进行。</p><p id="9f7a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我已经设置了一个名为<strong class="io ka"> timesTapped </strong>的变量，并将其初始值设置为0。接下来，我有一个<strong class="io ka"> buttonTapped() </strong>函数，还记得我们之前在ViewController文件中调用过它吗？这将使timesTapped值增加1，一旦我们点击按钮5次，我们将访问视图(协议)并调用<strong class="io ka"> updateLabel() </strong>函数。</p><p id="8fef" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">回到<strong class="io ka"> ViewController </strong>文件，我已经添加了ViewController类的扩展，并且符合<strong class="io ka"> PresenterView协议:</strong></p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="b2e7" class="ju jv hi jq b fi jw jx l jy jz"><strong class="jq ka">extension</strong> ViewController: PresenterView {</span><span id="1d69" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">   func</strong> updateLabel() {</span><span id="c215" class="ju jv hi jq b fi kb jx l jy jz">   changeTextLabel.text = "I have been changed!"</span><span id="85ec" class="ju jv hi jq b fi kb jx l jy jz"><strong class="jq ka">   self</strong>.view.backgroundColor = .yellow</span><span id="387e" class="ju jv hi jq b fi kb jx l jy jz">}</span><span id="869d" class="ju jv hi jq b fi kb jx l jy jz">}</span></pre><p id="b040" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是我们修改用户界面和操作视图的地方。最终结果看起来是这样的:</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kd"><img src="../Images/28d7c2c1bfce23a1fa24bdecc27408d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s8Rd-V6ZllU3Whn2UNCH-w.png"/></div></div></figure><p id="80af" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这只是MVP模型如何工作的一个非常简单的例子。请随时联系我们，寻求建议或改变。玩玩它，给你的VC添加更多的UI元素，疯狂地使用你的演示者的逻辑。</p></div></div>    
</body>
</html>