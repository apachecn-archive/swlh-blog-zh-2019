<html>
<head>
<title>Implementation of Linear Regression ğŸ“ˆ</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">çº¿æ€§å›å½’çš„å®ç°ğŸ“ˆ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/swlh/implementation-of-linear-regression-9fd58cb4656c?source=collection_archive---------22-----------------------#2019-06-29">https://medium.com/swlh/implementation-of-linear-regression-9fd58cb4656c?source=collection_archive---------22-----------------------#2019-06-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="781f" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">å¾ªåºæ¸è¿›çš„æ–¹æ³•</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/7d8500b01d2d85e377fdeed2ca34f305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eLSUnlg0AfLG7DKo.jpeg"/></div></div></figure><p id="13a7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">æˆ‘ä»¬å°†å¯¹'<strong class="jl kf"> Boston Housing </strong>'æ•°æ®é›†å®æ–½çº¿æ€§å›å½’ã€‚</p><p id="c7f4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">æ³¢å£«é¡¿æ•°æ®é›†åŒ…å«æ³¢å£«é¡¿ä¸åŒæˆ¿å±‹çš„ä¿¡æ¯ã€‚è¯¥æ•°æ®é›†ä¸­æœ‰506ä¸ªæ ·æœ¬å’Œ13ä¸ªç‰¹å¾å˜é‡ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯<strong class="jl kf">ä½¿ç”¨ç»™å®šçš„ç‰¹å¾</strong>é¢„æµ‹æˆ¿å­çš„ä»·æ ¼ã€‚</p><h2 id="8c44" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated"><strong class="ak">å¯¼å…¥å¿…è¦çš„åº“</strong></h2><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="c739" class="kg kh hi lc b fi lg lh l li lj">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt</span></pre><h2 id="701c" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated"><strong class="ak">å°†æ•°æ®é›†åŠ è½½åˆ°æ•°æ®æ¡†ä¸­</strong></h2><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="a862" class="kg kh hi lc b fi lg lh l li lj">data = pd.read_csv("boston.csv")</span></pre><p id="3efa" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">è·å–å…³äºæ³¢å£«é¡¿ä½æˆ¿æ•°æ®é›†çš„åŸºæœ¬ç»†èŠ‚ï¼Œå¦‚ç©ºå€¼æˆ–ç¼ºå¤±å€¼ã€æ•°æ®ç±»å‹ç­‰ã€‚æˆ‘ä»¬å¯ä»¥ç”¨<strong class="jl kf">ã€‚info() </strong>å¦‚ä¸‹æ‰€ç¤º:</p><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="e0c1" class="kg kh hi lc b fi lg lh l li lj">data.info()</span><span id="ff58" class="kg kh hi lc b fi lk lh l li lj">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 506 entries, 0 to 505<br/>Data columns (total 15 columns):<br/>Unnamed: 0    506 non-null int64<br/>CRIM          506 non-null float64<br/>ZN            506 non-null float64<br/>INDUS         506 non-null float64<br/>CHAS          506 non-null float64<br/>NOX           506 non-null float64<br/>RM            506 non-null float64<br/>AGE           506 non-null float64<br/>DIS           506 non-null float64<br/>RAD           506 non-null float64<br/>TAX           506 non-null float64<br/>PTRATIO       506 non-null float64<br/>B             506 non-null float64<br/>LSTAT         506 non-null float64<br/>target        506 non-null float64<br/>dtypes: float64(14), int64(1)<br/>memory usage: 59.4 KB</span></pre><h2 id="aec6" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated">å¤„ç†æ•°æ®æ¡†ä¸­çš„ç¼ºå¤±å€¼</h2><p id="c2e8" class="pw-post-body-paragraph jj jk hi jl b jm ll ij jo jp lm im jr js ln ju jv jw lo jy jz ka lp kc kd ke hb bi translated"><strong class="jl kf">å½“ä½¿ç”¨ã€‚head()æ–¹æ³•:</strong></p><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="7978" class="kg kh hi lc b fi lg lh l li lj">data.head()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lq"><img src="../Images/fb929c7d102480644242eb5e0f5402f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/0*m94IuYO1Y8-g6JfZ.png"/></div></figure><p id="7b23" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">é€šå¸¸ï¼Œ<strong class="jl kf"> NaNæˆ–ç¼ºå¤±å€¼</strong>å¯ä»¥æ˜¯ä»»ä½•å½¢å¼ï¼Œå¦‚<strong class="jl kf"> 0ã€ï¼Ÿæˆ–è€…å¯ä»¥å†™æˆ" missing" </strong>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤š0ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨NaNä»£æ›¿å®ƒä»¬æ¥è®¡ç®—æˆ‘ä»¬ä¸¢å¤±äº†å¤šå°‘æ•°æ®ã€‚</p><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="148e" class="kg kh hi lc b fi lg lh l li lj">data.ZN.replace(0, np.nan, inplace = True)<br/>data.CHAS.replace(0, np.nan, inplace = True)</span></pre><p id="22c6" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">ä½¿ç”¨<strong class="jl kf">æ›´æ¢åã€‚info() </strong>æ–¹æ³•æŸ¥çœ‹æ•°æ®é›†ä¸­ç¼ºå¤±å€¼çš„è¯¦ç»†ä¿¡æ¯:</p><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="b483" class="kg kh hi lc b fi lg lh l li lj">data.info()</span><span id="6110" class="kg kh hi lc b fi lk lh l li lj">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 506 entries, 0 to 505<br/>Data columns (total 15 columns):<br/>Unnamed: 0    506 non-null int64<br/>CRIM          506 non-null float64<br/>ZN            134 non-null float64<br/>INDUS         506 non-null float64<br/>CHAS          35 non-null float64<br/>NOX           506 non-null float64<br/>RM            506 non-null float64<br/>AGE           506 non-null float64<br/>DIS           506 non-null float64<br/>RAD           506 non-null float64<br/>TAX           506 non-null float64<br/>PTRATIO       506 non-null float64<br/>B             506 non-null float64<br/>LSTAT         506 non-null float64<br/>target        506 non-null float64<br/>dtypes: float64(14), int64(1)<br/>memory usage: 59.4 KB</span></pre><p id="a18a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">è®¡ç®—æ•°æ®é›†ä¸­ç¼ºå¤±å€¼çš„<strong class="jl kf">ç™¾åˆ†æ¯”ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœæœ‰20-25%çš„ç¼ºå¤±å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸åŒçš„æ–¹æ³•æ¥ä¼°ç®—ï¼Œå¦‚å‡å€¼æˆ–ä¸­å€¼ã€‚</strong></p><p id="f7d9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">ä½†æ˜¯å¦‚æœä¸æ­¢å¦‚æ­¤ï¼Œæœ€å¥½ç§»é™¤è¿™äº›ç‰¹å¾ï¼Œå¦åˆ™å®ƒä»¬ä¼šå½±å“æˆ‘ä»¬çš„ç»“æœã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ä¸‹é¢çœ‹åˆ°çš„ï¼Œ<strong class="jl kf">ã€ZNã€‘</strong>å’Œ<strong class="jl kf">ã€CHASã€‘</strong>éƒ½ä¸¢å¤±äº†è¶…è¿‡70%çš„æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬å°†åˆ é™¤è¿™ä¸¤ä¸ªç‰¹å¾ã€‚</p><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="0d70" class="kg kh hi lc b fi lg lh l li lj">data.isnull().sum() / len(data) * 100<br/>Unnamed: 0     0.000000<br/>CRIM           0.000000<br/>ZN            73.517787<br/>INDUS          0.000000<br/>CHAS          93.083004<br/>NOX            0.000000<br/>RM             0.000000<br/>AGE            0.000000<br/>DIS            0.000000<br/>RAD            0.000000<br/>TAX            0.000000<br/>PTRATIO        0.000000<br/>B              0.000000<br/>LSTAT          0.000000<br/>target         0.000000<br/>dtype: float64</span></pre><p id="8b50" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">ä¸‹é™åˆ—<strong class="jl kf">ã€ZNã€‘</strong><strong class="jl kf">ã€CHASã€‘</strong>ä»¥åŠ<strong class="jl kf">ã€æœªå‘½å:0ã€‘</strong>å¦‚ä¸‹å›¾æ‰€ç¤º:</p><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="5a71" class="kg kh hi lc b fi lg lh l li lj">data = data.drop(['ZN', 'CHAS', 'Unnamed: 0'], axis = 1)</span></pre><p id="cee7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">ç°åœ¨ï¼Œå†æ¬¡æ£€æŸ¥ä¸¢å¤±æ•°æ®çš„ç™¾åˆ†æ¯”ï¼Œä»¥ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç»§ç»­å·¥ä½œï¼Œè€Œä¸ç”¨æ‹…å¿ƒä¸¢å¤±æ•°æ®ã€‚</p><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="26eb" class="kg kh hi lc b fi lg lh l li lj">data.info()<br/>&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 506 entries, 0 to 505<br/>Data columns (total 12 columns):<br/>CRIM       506 non-null float64<br/>INDUS      506 non-null float64<br/>NOX        506 non-null float64<br/>RM         506 non-null float64<br/>AGE        506 non-null float64<br/>DIS        506 non-null float64<br/>RAD        506 non-null float64<br/>TAX        506 non-null float64<br/>PTRATIO    506 non-null float64<br/>B          506 non-null float64<br/>LSTAT      506 non-null float64<br/>target     506 non-null float64<br/>dtypes: float64(12)<br/>memory usage: 47.5 KB</span></pre><p id="2a10" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">è¿›ä¸€æ­¥è·å¾—ä¸€äº›å…³äºæˆ‘ä»¬çš„æ•°æ®ï¼Œå¦‚å¹³å‡å€¼ï¼Œä¸­ä½æ•°ï¼Œè®¡æ•°ç­‰åŸºæœ¬ä¿¡æ¯ã€‚ï¼Œæˆ‘ä»¬å°±ç”¨<strong class="jl kf">ã€‚</strong>æè¿°()æ–¹æ³•å¦‚ä¸‹æ‰€ç¤º:</p><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="37e7" class="kg kh hi lc b fi lg lh l li lj">data.describe()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lr"><img src="../Images/3ce2a410c945e0426de81de4b0f72346.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NMxWDIK-OoHLp7C5.png"/></div></div></figure><h2 id="b537" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated"><strong class="ak">åˆ†ç¦»å› å˜é‡å’Œè‡ªå˜é‡</strong></h2><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="715f" class="kg kh hi lc b fi lg lh l li lj">X = data.iloc[:,:-1]<br/>y = data.iloc[:,-1]</span></pre><h2 id="07f7" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated"><strong class="ak">å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†</strong></h2><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="ebef" class="kg kh hi lc b fi lg lh l li lj">from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.25, random_state = 0)</span></pre><h2 id="eeaf" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated"><strong class="ak">ä»sklearnå¯¼å…¥çº¿æ€§å›å½’ç±»</strong></h2><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="0b2b" class="kg kh hi lc b fi lg lh l li lj">from sklearn.linear_model import LinearRegression<br/>model = LinearRegression()<br/>model.fit(X_train, y_train) # Fitting our model to the training set</span></pre><h2 id="5e23" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated"><strong class="ak">ç°åœ¨ç”¨åšé¢„æµ‹ã€‚é¢„æµ‹()æ–¹æ³•</strong></h2><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="e730" class="kg kh hi lc b fi lg lh l li lj">y_pred = model.predict(X_test)</span></pre><h2 id="d448" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated"><strong class="ak">è®¡ç®—è¡¡é‡æ¨¡å‹æ€§èƒ½çš„æŒ‡æ ‡</strong></h2><p id="ad46" class="pw-post-body-paragraph jj jk hi jl b jm ll ij jo jp lm im jr js ln ju jv jw lo jy jz ka lp kc kd ke hb bi translated">è¿™é‡Œæˆ‘ä»¬è®¡ç®—äº†<strong class="jl kf">å¹³å‡ç»å¯¹è¯¯å·®(MAE)ã€å‡æ–¹è¯¯å·®(MSE)å’Œå‡æ–¹æ ¹è¯¯å·®(RMSE) </strong>ã€‚æˆ‘ä»¬è¿˜ä¸ºæˆ‘ä»¬çš„åˆ†ç±»å™¨è®¡ç®—äº†<strong class="jl kf">åˆ†æ•°</strong>ã€‚</p><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="429d" class="kg kh hi lc b fi lg lh l li lj">from sklearn import metrics <br/>print("MAE", metrics.mean_absolute_error(y_test, y_pred))<br/>print("MSE", metrics.mean_squared_error(y_test, y_pred))<br/>print("RMSE", np.sqrt(metrics.mean_squared_error(y_test, y_pred)))<br/>print("Score:", model.score(X_test, y_test))</span><span id="0985" class="kg kh hi lc b fi lk lh l li lj">MAE 3.773568493778742<br/>MSE 31.332023490151126<br/>RMSE 5.59750153998649<br/>Score: 0.6164944788849184</span></pre><p id="2629" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">è®©æˆ‘ä»¬ä¹Ÿåœ¨æµ‹è¯•é›†å’Œé¢„æµ‹é›†ä¸Šåšä¸€ä¸ªæ•£ç‚¹å›¾ï¼Œåœ¨ç†æƒ³æƒ…å†µä¸‹åº”è¯¥æ²¿ç€ä¸€æ¡ç›´çº¿ã€‚</p><pre class="iy iz ja jb fd lb lc ld le aw lf bi"><span id="15cc" class="kg kh hi lc b fi lg lh l li lj">plt.scatter(y_pred, y_test)<br/>plt.show()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ls"><img src="../Images/669d750c8fef03ab38418d731ab0f5be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/0*DPUma8qgewKJjlTY"/></div></div></figure><p id="e865" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç»“æœï¼Œä½†æ‚¨æ°¸è¿œä¸ä¼šä»¥è¿™ç§æ–¹å¼å¯¹æ³¢å£«é¡¿ä½æˆ¿æ•°æ®é›†ä½¿ç”¨çº¿æ€§å›å½’ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨æ­£åˆ™åŒ–æ¥è¿›ä¸€æ­¥çº¦æŸæ¨¡å‹ç³»æ•°ã€‚</p><p id="4da8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">å¥½äº†ï¼Œä¼™è®¡ä»¬ï¼Œä½ ä»¬å·²ç»å­¦ä¼šäº†å¦‚ä½•å¯¹â€œæ³¢å£«é¡¿ä½æˆ¿â€æ•°æ®é›†è¿›è¡Œçº¿æ€§å›å½’ã€‚ç°åœ¨ï¼Œç»§ç»­å°è¯•åœ¨æ‚¨é€‰æ‹©çš„ä»»ä½•æ•°æ®é›†ä¸Šå®ç°çº¿æ€§å›å½’ã€‚</p></div></div>    
</body>
</html>