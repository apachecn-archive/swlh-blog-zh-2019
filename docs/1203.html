<html>
<head>
<title>How I built horizontal as well as grid calendar in react-native using react-native-calendars</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何使用react-native-calendars在react-native中构建水平和网格日历</h1>
<blockquote>原文：<a href="https://medium.com/swlh/how-i-built-horizontal-as-well-as-grid-calendar-in-react-native-using-react-native-calendars-eb7a2edcc5db?source=collection_archive---------0-----------------------#2019-02-24">https://medium.com/swlh/how-i-built-horizontal-as-well-as-grid-calendar-in-react-native-using-react-native-calendars-eb7a2edcc5db?source=collection_archive---------0-----------------------#2019-02-24</a></blockquote><div><div class="es gl gm gn go gp"/><div class="gq gr gs gt gu"><div class=""/><p id="a76a" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">最近在我现在的公司，我得到了一个项目，我必须在react-native中制作一个日历UI。日历需要同时支持水平视图和网格视图。提供的模拟是这样的</p><figure class="it iu iv iw ek ix dy dz paragraph-image"><div class="dy dz is"><img src="../Images/c7e1952ded3eef49ace6023b604641d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*PqOWfTcZOpWU8yFhNprP1w.png"/></div><figcaption class="ja jb ea dy dz jc jd bd b be z ft">calendar in grid and list format</figcaption></figure><p id="6cc3" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">我在网上搜索并找到了react-native-calendars库<a class="ae je" href="https://github.com/wix/react-native-calendars" rel="noopener ugc nofollow" target="_blank">https://github.com/wix/react-native-calendars</a>，它与我的要求匹配度高达80%。它有以下日历组件-</p><figure class="it iu iv iw ek ix dy dz paragraph-image"><div class="dy dz jf"><img src="../Images/28b4c2d7472e80b880c66e644dabf39f.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/0*SFNncc96h1-4pLDY"/></div><figcaption class="ja jb ea dy dz jc jd bd b be z ft">react-native-calendars Calendar component</figcaption></figure><p id="1ba4" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">有几个问题-</p><ol class=""><li id="18de" class="jg jh gx hw b hx hy ib ic if ji ij jj in jk ir jl jm jn jo bi translated">我需要一个react-native-calendars不支持的自定义日历头(截至目前)</li><li id="8934" class="jg jh gx hw b hx jp ib jq if jr ij js in jt ir jl jm jn jo bi translated">日历还必须支持水平条形视图</li><li id="ec0c" class="jg jh gx hw b hx jp ib jq if jr ij js in jt ir jl jm jn jo bi translated">我需要自定义日组件，以适应我的项目需求</li></ol><p id="b90c" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">第三个问题已经解决，因为react-native-calendars支持自定义日组件，所以我所要做的就是编写自己的日组件，并将其作为prop <code class="eu ju jv jw jx b">dayComponent={CalendarDayComponent}.</code></p><p id="d618" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">为了解决第一个问题，我深入源代码并添加了对另外两个属性的支持- <code class="eu ju jv jw jx b">calendarHeaderComponent</code>和<code class="eu ju jv jw jx b">headerData.</code>。基本上，我检查用户是否提供了自己的头组件，如果是，那么使用它并传递<em class="jy"> headerData </em>作为它的附加属性，如果不是，那么回退到现有的头组件。<em class="jy"> headerData </em>是一个对象，它可以包含信息，例如在日历标题中显示的选定日期。</p><p id="8665" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">我用上面的更改创建了这个拉式请求(现在还没有合并)-<a class="ae je" href="https://github.com/wix/react-native-calendars/pull/747" rel="noopener ugc nofollow" target="_blank">https://github.com/wix/react-native-calendars/pull/747</a></p></div><div class="ab cl jz ka ge kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="gq gr gs gt gu"><p id="93d1" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">要解决的主要问题是提供对水平日历的支持。我使用带有<em class="jy"> horizontal </em>属性的<em class="jy"> ScrollView </em>来显示一个水平日历。我添加了一个新的道具<em class="jy">横向</em>来区分横向/网格日历视图。</p><pre class="it iu iv iw ek kg jx kh ki aw kj bi"><span id="17f5" class="kk kl gx jx b ev km kn l ko kp">  {<br/>    this.props.horizontal ?<br/>      &lt;ScrollView <br/>        style={[this.style.monthView, {flex: 1}]}<br/>        horizontal<br/>        ref={this.horizontalScrollViewRef}<br/>      &gt;<br/>        {weeks}<br/>      &lt;/ScrollView&gt;<br/>      : &lt;View style={this.style.monthView}&gt;{weeks}&lt;/View&gt;<br/>  }</span></pre><p id="3865" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">那么问题解决了吗？是的，但是还有一个问题——上面的代码在水平滚动条中显示了所选月份的周数，并且一次只有大约8天是可见的(不像网格视图中一个月中的所有日子都是可见的)。因此，如果选择的日子是月中/月末，它是不可见的，用户必须滚动来显示它。这可能会给用户造成混乱，所以我必须找到一种方法来自动滚动日历，使选定的日子可见。为了解决这个问题，我在渲染结束后以编程方式将日历滚动到所需的偏移量。</p><pre class="it iu iv iw ek kg jx kh ki aw kj bi"><span id="9a41" class="kk kl gx jx b ev km kn l ko kp">  // scroll the horizontal calendar to make selected date visible<br/>  componentDidUpdate() {<br/>    const horizontalScrollView = <br/>        this.horizontalScrollViewRef.current;<br/>    if (horizontalScrollView) {<br/>      const windowWidth = Dimensions.get('window').width;<br/>      horizontalScrollView.scrollTo({<br/>        x: horizontalScrollViewOffset * windowWidth,<br/>        animated: true<br/>      });<br/>    }<br/>  }</span></pre><p id="a49e" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">为了给库做最后的润色，我添加了两个新的道具<em class="jy">onpresslitview</em>和<em class="jy"> onPressGridView </em>来切换日历视图。</p><h2 id="4024" class="kk kl gx bd kq kr ks kt ku kv kw kx ky if kz la lb ij lc ld le in lf lg lh li bi translated">如何在您的项目中使用这种自定义日历？</h2><p id="c8e7" class="pw-post-body-paragraph hu hv gx hw b hx lj hz ia ib lk id ie if ll ih ii ij lm il im in ln ip iq ir gq bi translated">我分叉react-native-calendars repo，并在branch <strong class="hw lo"> horizontal_calendar中进行所有更改。</strong>要在您的项目中使用修改后的库，请在您的package.json-中使用github url添加包</p><pre class="it iu iv iw ek kg jx kh ki aw kj bi"><span id="d739" class="kk kl gx jx b ev km kn l ko kp"><strong class="jx lo">"react-native-calendars"</strong>: <strong class="jx lo">"git://git@github.com/varunon9/react-native-toggle-calendar.git#horizontal_calendar"</strong></span></pre><p id="9461" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">然后你可以像下面这样使用它-</p><pre class="it iu iv iw ek kg jx kh ki aw kj bi"><span id="fd85" class="kk kl gx jx b ev km kn l ko kp">&lt;<strong class="jx lo">Calendar<br/>  current=</strong>{<strong class="jx lo">this</strong>.<strong class="jx lo">state</strong>.<strong class="jx lo">calendarDate</strong>}<br/>  <strong class="jx lo">dayComponent=</strong>{CalendarDayComponent}<br/>  <strong class="jx lo">calendarHeaderComponent=</strong>{CalendarHeaderComponent}<br/>  <strong class="jx lo">headerData=</strong>{{<br/>    <strong class="jx lo">calendarDate</strong>: calendarDate.format(<strong class="jx lo">'DD MMM, YYYY'</strong>)<br/>  }}<br/>  <strong class="jx lo">style=</strong>{{<br/>    <strong class="jx lo">paddingLeft</strong>: 0, <strong class="jx lo">paddingRight</strong>: 0<br/>  }}<br/>  <strong class="jx lo">onPressArrowLeft=</strong>{<strong class="jx lo">this</strong>.onPressArrowLeft}<br/>  <strong class="jx lo">onPressArrowRight=</strong>{<strong class="jx lo">this</strong>.onPressArrowRight}<br/>  <strong class="jx lo">onPressListView=</strong>{<strong class="jx lo">this</strong>.onPressListView}<br/>  <strong class="jx lo">onPressGridView=</strong>{<strong class="jx lo">this</strong>.onPressGridView}<br/>  <strong class="jx lo">markedDates=</strong>{{<br/>    <strong class="jx lo">'2019-02-23'</strong>: {<strong class="jx lo">soldOut</strong>: <strong class="jx lo">false</strong>, <strong class="jx lo">blocked</strong>: <strong class="jx lo">false</strong>, <strong class="jx lo">inventory</strong>: 2},<br/>    <strong class="jx lo">'2019-02-24'</strong>: {<strong class="jx lo">soldOut</strong>: <strong class="jx lo">false</strong>, <strong class="jx lo">blocked</strong>: <strong class="jx lo">false</strong>, <strong class="jx lo">inventory</strong>: 2},<br/>    <strong class="jx lo">'2019-02-25'</strong>: {<strong class="jx lo">soldOut</strong>: <strong class="jx lo">false</strong>, <strong class="jx lo">blocked</strong>: <strong class="jx lo">true</strong>, <strong class="jx lo">inventory</strong>: 0},<br/>    <strong class="jx lo">'2019-02-26'</strong>: {<strong class="jx lo">soldOut</strong>: <strong class="jx lo">true</strong>, <strong class="jx lo">blocked</strong>: <strong class="jx lo">true</strong>, <strong class="jx lo">inventory</strong>: 2}<br/>  }}<br/>  <strong class="jx lo">horizontal=</strong>{<strong class="jx lo">this</strong>.<strong class="jx lo">state</strong>.<strong class="jx lo">horizontal</strong>}<br/>  <strong class="jx lo">onDayPress=</strong>{<strong class="jx lo">this</strong>.onDayPress}<br/>/&gt;</span></pre><h2 id="3f7b" class="kk kl gx bd kq kr ks kt ku kv kw kx ky if kz la lb ij lc ld le in lf lg lh li bi translated">最终结果-</h2><figure class="it iu iv iw ek ix dy dz paragraph-image"><div class="dy dz lp"><img src="../Images/4c61751a6c708946e707defc75c22ba2.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/1*pRdVFYAVRtXuqmp-puKFIQ.gif"/></div><figcaption class="ja jb ea dy dz jc jd bd b be z ft">react-native-toggle-calendar</figcaption></figure><h2 id="e263" class="kk kl gx bd kq kr ks kt ku kv kw kx ky if kz la lb ij lc ld le in lf lg lh li bi translated">完整代码-</h2><figure class="it iu iv iw ek ix"><div class="bz lq l di"><div class="lr ls l"/></div></figure><h2 id="62fd" class="kk kl gx bd kq kr ks kt ku kv kw kx ky if kz la lb ij lc ld le in lf lg lh li bi translated">结束注释</h2><p id="9dd7" class="pw-post-body-paragraph hu hv gx hw b hx lj hz ia ib lk id ie if ll ih ii ij lm il im in ln ip iq ir gq bi translated">我是第一次接触react-native，我真的很喜欢这种定制。我正在等待我的PR被合并到官方的react-native-calendars库，到那时我将使用github库作为依赖包。另外，这个库与react-native-web :D兼容</p><p id="5191" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">网址:<a class="ae je" href="https://github.com/varunon9/react-native-toggle-calendar" rel="noopener ugc nofollow" target="_blank">https://github . com/varunon 9/react-native-toggle-calendar/tree/horizontal _ calendar</a><br/>举例:<a class="ae je" href="https://github.com/varunon9/react-native-toggle-calendar/tree/master/ToggleCalendar" rel="noopener ugc nofollow" target="_blank">https://github . com/varunon 9/react-native-toggle-calendar/tree/master/toggle calendar</a></p><figure class="it iu iv iw ek ix dy dz paragraph-image"><a href="https://medium.com/swlh"><div class="dy dz lt"><img src="../Images/308a8d84fb9b2fab43d66c117fcc4bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YqDjlKFwScoQYQ62DWEdig.png"/></div></a></figure><h2 id="c148" class="kk kl gx bd kq kr ks kt ku kv kw kx ky if kz la lb ij lc ld le in lf lg lh li bi translated">这篇文章发表在<a class="ae je" href="https://medium.com/swlh" rel="noopener"> The Startup </a>上，这是Medium最大的创业刊物，拥有+428，678名读者。</h2><h2 id="869c" class="kk kl gx bd kq kr ks kt ku kv kw kx ky if kz la lb ij lc ld le in lf lg lh li bi translated">在这里订阅接收<a class="ae je" href="https://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="it iu iv iw ek ix dy dz paragraph-image"><a href="https://medium.com/swlh"><div class="dy dz lt"><img src="../Images/b0164736ea17a63403e660de5dedf91a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ouK9XR4xuNWtCes-TIUNAw.png"/></div></a></figure></div></div>    
</body>
</html>