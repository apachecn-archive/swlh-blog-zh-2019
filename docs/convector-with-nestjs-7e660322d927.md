# å¸¦ NestJS çš„å¯¹æµå™¨ğŸ¤¯

> åŸæ–‡ï¼š<https://medium.com/swlh/convector-with-nestjs-7e660322d927>

![](img/5e1d8e05eef4b91fbb40dbf2d52bf6be.png)

è¿™äº›å¤©æˆ‘ä¸€ç›´åœ¨ç© [Convector](https://www.worldsibu.tech/convector/) ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼€å‘æ™ºèƒ½åˆåŒå’ŒåŒºå—é“¾çš„ javascript æ¡†æ¶ã€‚è€å®è¯´ï¼Œæ„Ÿè°¢ WoldSibu ä¸º javascript ä¸–ç•Œå¸¦æ¥äº†å¦‚æ­¤ä¼Ÿå¤§çš„å·¥å…·ã€‚

> æˆ‘ä¸ä¼šè¿‡å¤šåœ°æ¢ç©¶ convector æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½†æ˜¯æˆ‘å¼ºçƒˆå»ºè®®ä½ åœ¨è¿™é‡Œ[æŸ¥çœ‹ä¸€ä¸‹](https://www.worldsibu.tech/convector/convector-smart-contracts/)ğŸ˜‰ã€‚

Convector åœ¨ä»–ä»¬çš„ç½‘ç«™ä¸Šæœ‰ä¸€å¥—æ•™ç¨‹ï¼Œç»™ä½ æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨è¿™ä¸ªæ¡†æ¶ã€‚æˆ‘æ³¨æ„åˆ°å…¶ä¸­ä¹‹ä¸€æ˜¯åˆ›å»ºä¸€ä¸ªå®šåˆ¶çš„åç«¯æ¥å…¬å¼€ä½¿ç”¨ NodeJS çš„ APIï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨ Expressã€‚

æˆ‘æƒ³çŸ¥é“æˆ‘æ˜¯å¦å¯ä»¥ä½¿ç”¨ä¸åŒçš„ NodeJS æ¡†æ¶æ¥ä»£æ›¿ Expressï¼Ÿï¼Ÿå¯èƒ½å—ï¼Ÿï¼ŸğŸ¤”ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼åªæ˜¯ Javascript è€Œå·²ã€‚æ‰€ä»¥æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨ [NestJS](https://nestjs.com/) ã€‚

ä½†æ˜¯ NestJS æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ä»–ä»¬çš„ç½‘ç«™ä¸Šï¼Œå®ƒè¢«å®šä¹‰ä¸ºâ€œä¸€ä¸ªæ¸è¿›çš„ Node.js æ¡†æ¶ï¼Œç”¨äºæ„å»ºé«˜æ•ˆã€å¯é å’Œå¯ä¼¸ç¼©çš„æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºã€‚â€å…¶ä¸­ä¸€ä»¶å¾ˆé…·çš„äº‹æƒ…æ˜¯ï¼Œå®ƒä¸ [Angular](https://angular.io/) éå¸¸ç›¸ä¼¼ï¼Œéµå¾ªç›¸åŒçš„æ¨¡å¼ï¼Œå¹¶å…·æœ‰ç±»ä¼¼çš„ç‰¹æ€§ï¼Œå¦‚æä¾›è€…ã€ç®¡é“ã€æ¨¡å—ã€‚

# ğŸ“å¼€å§‹ä¹‹å‰

*   å®‰è£…èŠ‚ç‚¹ 8(æ–‡æ¡£æ¨èçš„ç‰ˆæœ¬)
*   å®‰è£… docker
*   ç»§ç»­ä¹‹å‰ï¼Œè¯·é˜…è¯» convector ç½‘ç«™ä¸Šçš„[æ™ºèƒ½åˆåŒæ•™ç¨‹](https://docs.worldsibu.com/article/89-tutorial)ã€‚

# â°è¯´å¾—å¤ªå¤šäº†ï¼Œä¼™è®¡ï¼Œä¼™è®¡ï¼

æˆ‘ä»¬å°†ä½¿ç”¨[åç«¯](https://docs.worldsibu.com/article/95-tutorial-back-end)æ•™ç¨‹ä¸­æä¾›çš„ç¤ºä¾‹ä½œä¸ºæˆ‘ä»¬çš„åŸºç¡€é¡¹ç›®ï¼Œç„¶åå°† Express åº”ç”¨ç¨‹åºè¿ç§»åˆ° NestJSã€‚å°†å›è´­[å‰åˆ°è¿™é‡Œ](http://sibu/convector-example-people-attributes)ã€‚

# ğŸ› è®¾ç½®

è¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¦åˆ™ï¼Œæ‚¨å¯èƒ½ä¼šé‡åˆ°ä¸€äº›å¥‡æ€ªçš„é”™è¯¯:

1.  å®‰è£… [Hurley](https://worldsibu.tech/convector/hurley-development-environment/) å¸®åŠ©æˆ‘ä»¬å»ºç«‹æµ‹è¯•ç½‘ç»œ
    
2.  è¿è¡Œ`rm -rf ./packages/server`åˆ é™¤ Express App
3.  è¿è¡Œ`npm install -g @nestjs/cli`å®‰è£… [NestJS](https://nestjs.com) CLI
4.  ç§»åŠ¨åˆ°`package`æ–‡ä»¶å¤¹è¿è¡Œ`nest new server`ã€‚è¿™å°†ä¸ºä½ æ­å»ºä¸€ä¸ª NestJS é¡¹ç›®ã€‚
5.  è®¿é—®æœåŠ¡å™¨æ–‡ä»¶å¤¹`cd server`
6.  å®‰è£…`dotenv`ç”¨äºå¤„ç†ç¯å¢ƒå˜é‡
    `npm i dotenv --save-dev`
7.  **å›åˆ°é¡¹ç›®çš„æ ¹ç›®å½•**ï¼Œå®‰è£… NestJS
    `npx lerna add participant-cc --scope server --no-bootstrap
    npx lerna add person-cc --scope server --no-bootstrap`å°†è¦ä½¿ç”¨çš„æ™ºèƒ½åˆçº¦åŒ…
8.  ä¸ºäº†é¿å…é”®å…¥å†²çªï¼Œåœ¨**æ ¹**å’Œ**æœåŠ¡å™¨** `tsconfig`æ–‡ä»¶ä¸­æ·»åŠ `skipLibCheck`æ ‡å¿—ã€‚(NestJS ç”¨çš„ Jest å’Œ Convector ç”¨çš„ Mocha ä¹‹é—´æœ‰é—®é¢˜)

![](img/33aad63978c5aaf9fe89374b8d493047.png)

root/tsconfig.json

9.æœ€åæ˜¯`npm install`

> å¦‚æœ npx ä¸èµ·ä½œç”¨ï¼Œè¯·æ›´æ–° NPM ç‰ˆæœ¬ï¼Œæˆ–è€…é€šè¿‡è¿è¡Œ npm install -g lerna å¹¶è¿è¡Œä¸å¸¦ npx çš„ç›¸åŒå‘½ä»¤æ¥å…¨å±€å®‰è£… lerna

# ğŸ‘·ğŸ»â€â™‚ï¸æˆ‘ä»¬è¦å»ºé€ ä»€ä¹ˆï¼Ÿ

æˆ‘ä»¬å°†é‡ç”¨åœ¨[æ™ºèƒ½åˆçº¦æ•™ç¨‹](https://docs.worldsibu.com/article/89-tutorial)ä¸­åˆ›å»ºçš„ä¸¤ä¸ªæ™ºèƒ½åˆçº¦ï¼Œå¹¶ä½¿ç”¨ NestJS é€šè¿‡ç«¯ç‚¹å…¬å¼€å®ƒä»¬ã€‚

ä»¥ä¸‹æ˜¯æ™ºèƒ½åˆçº¦æ•™ç¨‹ä¸­å¯¹å®ƒçš„ç®€è¦è¯´æ˜:

1.  åŒºå—é“¾ä¸­æœ‰ä¸‰ç§æ•°æ®ç»“æ„:**ç½‘ç»œå‚ä¸è€…ã€å±æ€§å’Œäººã€‚**
2.  æ¯ä¸ªæ•°æ®ç»“æ„è¢«å®šä¹‰ä¸º:

*   **ç½‘ç»œå‚ä¸è€…:**è¿™äº›æ˜¯ç½‘ç»œä¸­å‘å¸ƒå±æ€§çš„å…¬å¸ã€‚å®ƒä»¬å¯¹å®ƒä»¬å‘ç”¨æˆ·é™ˆè¿°çš„å†…å®¹è´Ÿè´£ï¼Œå¹¶ä¸”åœ¨ç½‘ç»œä¸­æ˜¯å¯è¯†åˆ«çš„ã€‚
*   **å±æ€§:**æ˜¯**ç½‘ç»œå‚ä¸è€…**ä¸º**äºº**åšè¯æ˜çš„å£°æ˜ã€‚
*   è¿™äº›æ˜¯ç½‘ç»œä¸­çš„äººç‰©ä»£è¡¨ã€‚å®ƒä»¬è¢«åˆ†é…äº†å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€è¦åœ¨ç¬¬ä¸‰æ–¹é¢å‰ç®€å•åœ°æŸ¥è¯¢å®ƒä»¬ä»¥è¿›è¡Œè®¤è¯ã€‚

3.å•†ä¸šè§„åˆ™

*   åˆ›é€ ä¸€ä¸ª ***äºº*** åº”è¯¥åªæ˜¯ä¸€ä¸ªç»„ç»‡çš„è´£ä»»â€”â€”æ”¿åºœã€‚
*   æ¯ä¸ªç»„ç»‡( ***ç½‘ç»œå‚ä¸è€…*** )åº”è¯¥èƒ½å¤Ÿå‘å¸ƒæˆ–è¯æ˜å±æ€§ã€‚
*   æ¯ä¸ªç»„ç»‡( ***ç½‘ç»œå‚ä¸è€…*** )åº”è¯¥èƒ½å¤Ÿæ£€æŸ¥/æŸ¥è¯¢ä¸€ä¸ªäººçš„å±æ€§ã€‚
*   å•ä¸ª ID åº”è¯¥è¶³ä»¥æŸ¥è¯¢ä¸€ä¸ªäººåŠå…¶å±æ€§çš„æ‰€æœ‰ç›¸å…³ä¿¡æ¯ã€‚
*   åªæœ‰è®¤è¯å±æ€§çš„ç»„ç»‡æ‰èƒ½ç¼–è¾‘å®ƒã€‚

æµç¨‹åº”è¯¥æ˜¯è¿™æ ·çš„:

*   æ”¿åºœå¯ä»¥â€œæ‹›æ”¶â€ä¸€ä¸ªæ–°äººã€‚
*   æ”¿åºœå¯ä»¥é»˜è®¤ç»™é‚£ä¸ªäººåŠ ä¸€äº›å±æ€§ã€‚
*   ç„¶åï¼Œå…¶ä»–æœºæ„å°±å¯ä»¥å¼€å§‹å‘æ”¾å±æ€§(èŒä¸šã€ä¿é™©çŠ¶æ€ã€å·¥ä½œç»éªŒ)ã€‚
*   å‘å¸ƒçš„å±æ€§ä¸­çš„æ¯ä¸€ä¸ªå˜åŒ–éƒ½å°†æ˜¯æ˜æ˜¾çš„ã€‚åªæœ‰æœ€åˆå‘å¸ƒå±æ€§çš„ç»„ç»‡æ‰èƒ½å¯¹å±æ€§è¿›è¡Œæ›´æ”¹ã€‚

> å®šä¹‰å’Œä¸šåŠ¡è§„åˆ™æ‘˜è‡ª[æ•™ç¨‹](https://docs.worldsibu.com/article/89-tutorial)

è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£:

å‡è®¾ä¸€ä¸ª ***ç½‘ç»œå‚ä¸è€…*** æ˜¯æ”¿åºœï¼Œä¸€ä¸ª ***äºº*** æ˜¯ä½ ï¼Œä¸€ä¸ª ***å±æ€§*** æ˜¯ä½ çš„å‡ºç”Ÿè¯æ˜ã€‚æ”¿åºœè´Ÿè´£ç™»è®°ä½ çš„ç”Ÿæ—¥ï¼Œå¹¶é¢å‘å‡ºç”Ÿè¯æ˜ï¼Œä½ ä¼šå­˜å‚¨ã€‚ä½†æ˜¯å› ä¸ºæŸäº›åŸå› ï¼Œä½ çš„åå­—æœ‰ä¸ªé”™åˆ«å­—(å¯¹ä¸èµ·ä½ ğŸ˜‚)åœ¨è¯æ˜é‡Œä¹Ÿåªæœ‰å¿æ³•é™¢(å¦ä¸€ä¸ª ***ç½‘ç»œå‚ä¸è€…*** é‚£ä¸ªä¸æ˜¯æ”¿åºœ)å¯ä»¥å¸®ä½ ã€‚å¿æ³•é™¢å¯ä»¥ä¿®æ­£ä½ çš„åå­—ï¼Œä½†ä¸èƒ½åˆ›é€ å¦ä¸€ä¸ª ***äºº*** ã€‚

# ğŸ‘¨ğŸ»â€ğŸ’»ä»£ç ä»£ç 

æˆ‘ä»¬å·²ç»å¯åŠ¨äº† NestJS é¡¹ç›®ï¼Œä¸‹ä¸€æ­¥æ˜¯ä¸ºæ¯ä¸ªæ™ºèƒ½åˆçº¦åˆ›å»ºä¸€ä¸ªæ¨¡å—ã€ä¸€ä¸ªæ§åˆ¶å™¨å’Œä¸€ä¸ªæœåŠ¡ã€‚

å…ˆè¯´`participant`é€»è¾‘ã€‚è¦ç”Ÿæˆæ¨¡å—è¿è¡Œ:

> `nest generate module participant`

è¯¥å‘½ä»¤å°†åˆ›å»º`participant`æ¨¡å—ï¼Œå¹¶è‡ªåŠ¨å°†å…¶æ³¨å†Œåˆ° app æ¨¡å—ä¸­ã€‚

> ä½¿ç”¨ Nest CLI è¿è¡Œçš„æ¯ä¸ªå‘½ä»¤éƒ½ä¼šè‡ªåŠ¨å°†åŠŸèƒ½(æä¾›ç¨‹åºã€æ¨¡å—ã€ç®¡é“ç­‰)æ³¨å†Œåˆ°ä½œç”¨åŸŸæ¨¡å—(å¦‚æœå­˜åœ¨),å¦åˆ™å®ƒå°†è¢«æ·»åŠ åˆ°åº”ç”¨ç¨‹åºæ¨¡å—ã€‚

è¦åˆ›å»ºæ§åˆ¶å™¨:

> `nest generate controller participant`

è®©æˆ‘ä»¬å¯¹`person`åšåŒæ ·çš„äº‹æƒ…ï¼Œä½†æ˜¯è¿™æ¬¡æˆ‘ä»¬å°†ä¸ºè¿™ä¸ªæ¨¡å—åˆ›å»ºä¸€ä¸ªæœåŠ¡:

> `*nest generate module* person`
> 
> `*nest generate controller* person`
> 
> `*nest generate service* person`

å¹¶åœ¨`src`æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶:`env.ts`å’Œ`convector.ts`:

src/server/env.ts

packages/server/src/convector.ts

æ‚¨çš„ src æ–‡ä»¶å¤¹åº”è¯¥å¦‚ä¸‹æ‰€ç¤º

![](img/b9ed29c45486e32b99bc82d004be8967.png)

NestJS source folder

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯å¼€å§‹è¿ç§»é€»è¾‘ã€‚æ‰€æœ‰ä¸ convector é€šä¿¡ç›¸å…³çš„ä»£ç ä»¥åŠä»»ä½•å…¶ä»–å¯¹æˆ‘ä»¬çš„æœåŠ¡å’Œæ§åˆ¶å™¨çš„ç¹é‡è®¡ç®—éƒ½å°†è´Ÿè´£æš´éœ²ç«¯ç‚¹å¹¶å°†æ•°æ®ä¼ é€’ç»™æœåŠ¡ã€‚

å¤åˆ¶å¹¶ç²˜è´´åˆ°ç›¸åº”çš„æ–‡ä»¶

**å‚ä¸è€…æ§åˆ¶å™¨**

**ä¸ªäººæœåŠ¡**

**ä¸ªäººæ§åˆ¶å™¨**

# âš™ï¸è¿è¡Œå¯¹æµå™¨å’Œæµ‹è¯•

è®©æˆ‘ä»¬è¿è¡Œåç«¯æ•™ç¨‹ä¸­ä½¿ç”¨çš„ç›¸åŒå‘½ä»¤:

1.  ç¡®ä¿ Docker æ­£åœ¨è¿è¡Œã€‚
2.  è½¬åˆ°æ ¹ç›®å½•å¹¶è¿è¡Œ:

3.æµ‹è¯•ç«¯ç‚¹

![](img/18c4ee4cb08ab732a9a261e745a97bc2.png)

[http://localhost:3000/participant/gov](http://localhost:3000/participant/gov)

![](img/2a3199c671ed11b3a5d473fbaae492b5.png)

[http://localhost:3000/participant/mit](http://localhost:3000/participant/mit)

4.åšå‡ ç¬”äº¤æ˜“

ç»“æœ:

![](img/ad276b73bf15b638215bbfc087305a3f.png)

# ç»“è®º

Convector æ˜¯ä¸€ä¸ªä½¿ç”¨ javascript åˆ›å»ºæ™ºèƒ½åˆåŒçš„ä¼Ÿå¤§å·¥å…·ï¼Œå®ƒæ˜¯ web å¼€å‘äººå‘˜çš„åˆä¸€ä¸ªé€‰æ‹©ã€‚æˆ‘è§‰å¾—å®ƒä¸æ‹˜æ³¥äº NodeJS æ¡†æ¶å¾ˆæ£’ã€‚å¦ä¸€æ–¹é¢ï¼ŒNestJS æ˜¯ä¸€ä¸ªå— Angular å¯å‘çš„éå¸¸å¥å£®çš„æ¡†æ¶ï¼Œå…è®¸å‰ç«¯å¼€å‘äººå‘˜è½»æ¾åœ°è¿ç§»åˆ°åç«¯ã€‚

ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹

æˆ‘æ˜¯ä¸€å Web å¼€å‘äººå‘˜ï¼Œä¸€å javascript çˆ±å¥½è€…ğŸ¤“ï¼Œè¿˜æœ‰å¥½åƒçš„ğŸ•ï¼Œä»åœ¨äº†è§£åŒºå—é“¾ã€‚ä»»ä½•å»ºè®®éƒ½ä¼šå—åˆ°æ¬¢è¿ã€‚è·Ÿæˆ‘æ¥:

[![](img/6d60b235fcc46a4bd696b90e886419ee.png)](https://www.buymeacoffee.com/mahcr)[](https://twitter.com/malvarezcr) [## é©¬é‡Œäºšè¯ºÂ·ÃÂ·é˜¿å°”ç“¦é›·æ–¯(@malvarezcr) |æ¨ç‰¹

### (@malvarezcr)ã€‚|ğŸ¤–é«˜çº§ç½‘é¡µå¼€å‘|ğŸ‘¨ğŸ»â€ğŸ’»ç½‘ç»œå®è·µè´Ÿè´£äºº|â™¥ï¸Â·å´ï¼ŒğŸ®,ğŸ•â€¦

twitter.com](https://twitter.com/malvarezcr)  [## é©¬é‡Œäºšè¯ºÂ·é˜¿å°”ç“¦é›·æ–¯-ä¸­ç­‰

### é«˜çº§ç½‘é¡µå¼€å‘å‘˜-ååŠå•ä½ Angular å“¥æ–¯è¾¾é»åŠ 

medium.com](/@mahcr/)