<html>
<head>
<title>💸 How I created frugalfashion.xyz</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">💸我如何创建frugalfashion.xyz</h1>
<blockquote>原文：<a href="https://medium.com/swlh/how-i-created-frugalfashion-xyz-8eae0f6dc364#2019-01-30">https://medium.com/swlh/how-i-created-frugalfashion-xyz-8eae0f6dc364#2019-01-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="94a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我注意到我的几个朋友虔诚地查看subreddit<a class="ae jd" href="https://reddit.com/r/frugalmalefashion" rel="noopener ugc nofollow" target="_blank">r/frugalmalfashion</a>上的交易，特别是<a class="ae jd" href="https://en.wikipedia.org/wiki/Common_Projects" rel="noopener ugc nofollow" target="_blank">的普通项目</a>下降。在2018年假期期间，我创建了<a class="ae jd" href="https://frugalfashion.xyz" rel="noopener ugc nofollow" target="_blank"> frugalfashion.xyz </a>，这是一个跟踪<a class="ae jd" href="https://www.reddit.com/r/frugalmalefashion" rel="noopener ugc nofollow" target="_blank">r/frugalfalefashion</a>和<a class="ae jd" href="https://www.reddit.com/r/frugalfemalefashion" rel="noopener ugc nofollow" target="_blank">r/frugalfalefashion</a>的网络应用程序。用户通过关键词指定他们感兴趣的产品，然后应用程序使用它们过滤子关键词。这些过滤器用于发送相关帖子的电子邮件通知，并通过<a class="ae jd" href="https://twitter.com/rfrugalfashion" rel="noopener ugc nofollow" target="_blank"> tweets </a>将它们发送出去！那么我是怎么做到的呢？</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/1d3a7c1d495a1a802f50de1c4621a15a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CNdkqlrNhpOlqZHqhipZjQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx"><strong class="bd ju">Original design</strong></figcaption></figure><h2 id="5f01" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">概观</h2><ol class=""><li id="c8c9" class="kq kr hi ih b ii ks im kt iq ku iu kv iy kw jc kx ky kz la bi translated"><strong class="ih lb"> Cron脚本</strong>民意调查reddit</li><li id="ce9f" class="kq kr hi ih b ii lc im ld iq le iu lf iy lg jc kx ky kz la bi translated">Mysql 存储新帖子</li><li id="ca2a" class="kq kr hi ih b ii lc im ld iq le iu lf iy lg jc kx ky kz la bi translated"><strong class="ih lb"> SQL插入触发下游作业</strong> —电子邮件和twitter通知</li><li id="c0da" class="kq kr hi ih b ii lc im ld iq le iu lf iy lg jc kx ky kz la bi translated"><strong class="ih lb"> CRUD服务器</strong> —提供用户界面，从mysql获取帖子</li><li id="e3c9" class="kq kr hi ih b ii lc im ld iq le iu lf iy lg jc kx ky kz la bi translated"><strong class="ih lb"> Firebase </strong> —验证并存储用户元数据</li></ol><p id="9b15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实证明firebases的免费层对于每个用户的几个关键字和切换来说有足够的空间。唯一隐现的限制是支持并发http连接，它被限制为100个。在<a class="ae jd" href="https://frugalfashion.xyz" rel="noopener ugc nofollow" target="_blank"> frugalfashion.xyz </a>的例子中，平均并发连接数是25，所以现在一切正常🤞</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lh"><img src="../Images/edd2ac1f612a348a58c8448b15a22c36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ILBpmJjhpzgIC3OEutsFiw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx"><strong class="bd ju">Finalized design</strong></figcaption></figure><h2 id="231a" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">投票Reddit</h2><p id="8467" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">crontab是我定期投票给reddit的首选武器。我选择cron轮询是因为它的守护进程性质，独立于web应用程序。总体愿景是一系列可供消费的帖子，无论是web应用程序用户、电子邮件通知还是twitter通知。将轮询逻辑从这些服务中分离出来是必要的，cron守护进程完美地体现了这种行为。使用crons的唯一缺点是分钟是最低级别的时间粒度，限制了每分钟一次的轮询频率。缓解时间限制的替代解决方案是<a class="ae jd" href="https://twistedmatrix.com/documents/9.0.0/api/twisted.internet.task.LoopingCall.html" rel="noopener ugc nofollow" target="_blank">循环调用</a>或休眠的无限循环，类似于<a class="ae jd" href="https://github.com/justiniso/polling/blob/master/polling.py#L100" rel="noopener ugc nofollow" target="_blank"> python轮询</a>的实现。</p><h2 id="0618" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">存储帖子</h2><p id="296f" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">mysql 是我的首选数据库，因为它简单、具有ACID属性，并且有丰富的binlog处理软件。binlog是mysql在每次数据库发生变化时写入的日志文件。我想通过kafka作为实时通知的代理来试验被动的日志消耗。或者，我可以直接从cron脚本发送通知。然而，更多的逻辑将被添加到cron中，它有一分钟长的时间限制，我将有一个更大的脚本，这很无聊😊。</p><p id="74f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回想起来，一个<a class="ae jd" href="https://www.elastic.co/products/elasticsearch" rel="noopener ugc nofollow" target="_blank"> elasticsearch </a>集群在通过关键字搜索帖子和进行更复杂的字符串查询(这是这个应用程序的本质)时会更有性能，但是，对于当前的应用程序状态来说，它是多余的。</p><h2 id="0e9a" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">使用二进制日志</h2><p id="08c0" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">卡夫卡和马克斯韦尔是唯一可靠的久经沙场的老兵。Kafka是一个等待从生产者那里获取数据的服务器。麦克斯韦是我们卡夫卡的制片人；一个服务器跟踪mysql binlog并在post inserts上写入kafka主题，我们使用它来发送twitter和电子邮件通知。我之前提到过，我正在被动地阅读binlog来模拟实时通知，这都是通过maxwell和kafka提供的生产者/消费者模型来完成的。我可以廉价地创建另一个kafka消费者来索引一个弹性搜索集群，以进行更高性能的关键字搜索。</p><h2 id="b8e6" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">通知</h2><p id="84ea" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">Twitter和电子邮件通知是作为kafka消费者单独设置的。对于twitter，tweets是在每个具有适当标签的插入页上创建的。对于电子邮件，遵循类似的过程，但需要注意的是，会进行firebase查询，以确定哪些用户想要所有通知的电子邮件，或者只想要包含其指定关键字的特定通知的电子邮件。我目前使用<a class="ae jd" href="https://www.mailgun.com/" rel="noopener ugc nofollow" target="_blank"> mailgun </a>作为我的专用smtp服务器，最初并不太好，因为免费层服务器的<a class="ae jd" href="https://help.returnpath.com/hc/en-us/articles/220569187-What-is-Sender-Score-and-how-is-it-calculated-" rel="noopener ugc nofollow" target="_blank">发送分数</a>很低。升级后，电子邮件停止反弹，并成功发送。</p><h2 id="689d" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">CRUD应用</h2><p id="2cd5" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">我使用<a class="ae jd" href="https://www.tornadoweb.org/en/stable/" rel="noopener ugc nofollow" target="_blank"> tornado </a>是因为我❤ Python，tornado的配置非常简单。这个web应用程序是轻量级的，只服务于UI和查询mysql中的帖子。</p><h2 id="953b" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">漂亮的用户界面</h2><p id="00b8" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">作为一个极简主义者，我喜欢大而无重的UI元素，我使用了Pinterest的UI框架<a class="ae jd" href="https://pinterest.github.io/gestalt/" rel="noopener ugc nofollow" target="_blank">完形</a>！在这个项目之前，我从未使用过格式塔，它使用起来非常简单，尤其是与谷歌的<a class="ae jd" href="https://material-ui.com/" rel="noopener ugc nofollow" target="_blank"> material ui </a>相比。当React框架通过组件组合而不是组件配置提供高度可定制性时，我发现了它的价值。这意味着组件本质上是瘦的，只有必要的道具，并且是包含非常基本和通用组件的库的一部分。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="d75e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意上面代码片段中的组件是如何通用的，然而每一个都用少量的道具服务于它们的目的。这些组件生成帖子列表，看起来很棒，对显示事件反应良好，不需要大量的道具定制。</p><h2 id="6562" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">支持基础设施</h2><p id="a65f" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">我使用<a class="ae jd" href="https://www.digitalocean.com/pricing/" rel="noopener ugc nofollow" target="_blank">数字海洋</a>五美元的服务器来托管和服务一切。疯狂吧？虽然这并不都是阳光和玫瑰，但我不得不牺牲存储空间来交换，以便为臭名昭著的内存猪<a class="ae jd" href="https://kafka.apache.org/" rel="noopener ugc nofollow" target="_blank">卡夫卡</a>获得更多可用内存。<a class="ae jd" href="https://www.freedesktop.org/software/systemd/man/systemd.html" rel="noopener ugc nofollow" target="_blank"> Systemd </a>是一个进程管理器，支持快速进程启动、重启、终止以及相关的内存使用指标。</p><h2 id="d001" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">考虑</h2><p id="996d" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">在过去，我的应用架构通常是由web服务器、nginx和mongodb组成的。这消耗了大量的内存，使微调优化和部署麻烦。例如，对通知系统的更改将需要整个服务器的重建和部署，这是不理想的。</p><p id="d30d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了性能下降，我还会遭受脆弱的逻辑耦合。这通常会扼杀继续项目的动力，更不用说解决后期制作问题了。</p><p id="4a09" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于这个应用程序，我决定采用面向服务的结构，将功能拆分到由<a class="ae jd" href="https://www.freedesktop.org/software/systemd/man/systemd.html#" rel="noopener ugc nofollow" target="_blank"> systemd </a>监控的多个任务中。这让我可以专注于需要注意的特定部分，而不会被系统的其他部分淹没。应用程序的每一部分都非常小和轻量级，鼓励更干净、简洁的代码，我不介意在未来处理这些代码。我在nginx后面通过Systemd分别部署每个通知服务和web应用程序。</p><p id="fc07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">未来的下游消费者很容易通过我的kafka消费者模板创建，这些模板独立存在，完全独立于现有的服务。如果这是一个单一的web应用程序，我将需要通读代码来找到我调用服务的地方，并进行必要的修改。</p><p id="5f4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们清楚地知道，这种方法远非完美。与耦合的逻辑和大文件不同，人们必须处理多个服务的协调，并跟踪系统如何相互协作。这是一个不同的问题，对我来说是一个新的问题，我现在很喜欢这个问题。</p></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><h2 id="4d4c" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">结论</h2><p id="f1b3" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">总的来说，我对这个结果很满意🤗。该应用受到了社区的好评，在一周内获得了两个reddit帖子的266次投票，2K页面浏览量和300次注册。最酷的部分是当一个redditor <a class="ae jd" href="https://twitter.com/aarbypls/status/1087867053082640384" rel="noopener ugc nofollow" target="_blank">转发我的机器人</a>通知他一笔交易时。点击<a class="ae jd" href="https://www.reddit.com/r/frugalmalefashion/comments/addsmp/get_notifications_filter_posts_here_on/" rel="noopener ugc nofollow" target="_blank">这里</a>收听未来的功能更新和发布💪。</p><p id="fba3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih lb"> <em class="lu">如果你喜欢这篇文章，并想继续讨论，或戳我的大脑关于任何事情，请随时联系@</em></strong><a class="ae jd" href="mailto:ihsanetwaroo@gmail.com" rel="noopener ugc nofollow" target="_blank"><strong class="ih lb"><em class="lu">ihsanetwaroo@gmail.com</em></strong></a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><a href="https://medium.com/swlh"><div class="er es lv"><img src="../Images/308a8d84fb9b2fab43d66c117fcc4bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YqDjlKFwScoQYQ62DWEdig.png"/></div></a></figure><h2 id="c148" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">这篇文章发表在<a class="ae jd" href="https://medium.com/swlh" rel="noopener"> The Startup </a>上，这是Medium最大的创业刊物，拥有+418，678名读者。</h2><h2 id="869c" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">在这里订阅接收<a class="ae jd" href="http://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="jf jg jh ji fd jj er es paragraph-image"><a href="https://medium.com/swlh"><div class="er es lv"><img src="../Images/b0164736ea17a63403e660de5dedf91a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ouK9XR4xuNWtCes-TIUNAw.png"/></div></a></figure></div></div>    
</body>
</html>