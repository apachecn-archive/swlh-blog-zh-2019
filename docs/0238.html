<html>
<head>
<title>Smart-card-based mobile wallets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于智能卡的移动钱包</h1>
<blockquote>原文：<a href="https://medium.com/swlh/smart-card-based-mobile-wallets-9cb75595b71d?source=collection_archive---------0-----------------------#2019-01-13">https://medium.com/swlh/smart-card-based-mobile-wallets-9cb75595b71d?source=collection_archive---------0-----------------------#2019-01-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2f3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在今天这一期可以使用IP nChain开发的商业创意中，我将详细介绍智能卡应用程序如何既有助于保护比特币钱包，又允许匿名(私人)和安全的系统认证。</p><p id="8b70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们(nChain)已经获得或被授予了一项专利[3],将ECDSA作为一种安全共享和创建密钥的方法。该机制可用于创建一个系统，允许用户向计算机进行身份验证，或创建一个钱包密钥存储库，该存储库可与智能卡和移动电话配合使用，允许一次性比特币密钥始终更新地址。</p><p id="82d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">具有生物识别功能的Java智能卡的存在并不新鲜；这种卡开始被广泛使用。</p><p id="31dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">钱包可以用作智能手机上的应用程序。以下过程中使用的数据可以公开保存而不损失任何安全性，可以写入区块链，也可以备份，以便在丢失时可以恢复。</p><p id="aaae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在交换的基础部分的ECDSA密钥在区块链上保持未公开和不可公开获得的情况下，可以发行生物识别智能卡。相关联的地址甚至可以在PKI(公钥基础设施)上证明，其中比特币地址(而不是公钥)由CA(认证机构)记录。这样做甚至可以实现基于反洗钱/KYC的完整身份系统，身份生物识别卡(如英国居留卡或护照)将允许使用Java ECDSA流程。</p><p id="f01f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这样的过程解决了PKI和隐私的所有问题。</p><p id="5eb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们以专利中的例子为例，我们现在用智能卡取代了笔记本电脑。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/f18595db7bc27ac558f8a1fc22238a71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qMdmFc7_OTIsjAtpkFJv-A.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">NFC-based key exchange as per 1092/42</figcaption></figure><p id="cb8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们以一个允许在设备(比如电话)上签名密钥的系统结束。在这里，密钥存储为一个联合流程:</p><p id="2bfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P0 =秘密(智能卡)X G (G是ECDSA固化运算符)</p><p id="cbc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pi =秘密(钱包值)X G</p><p id="2b65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">区块链上的“币帮<em class="jd">”</em>是c复合；也就是说，钱包值加上智能卡密码，用户可以备份钱包。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ju"><img src="../Images/aaae99615b2844c1f8d89e9a8ef995ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/0*gka-tT3b2xRJMxz1.jpg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Smart cards that use biometrics are now available.</figcaption></figure><p id="5dee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">手机上的应用程序将硬币秘密(钱包值)与交易哈希一起发送到智能卡。为此，该应用程序将交易的散列(手机具有允许交易被构造的“智能”)和秘密(钱包值)构造到智能卡中。</p><p id="63d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">智能卡使用复合密钥对哈希进行签名:</p><ul class=""><li id="c9e3" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated">S = secret(钱包值)+ secret(智能卡)</li></ul><p id="c1aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，用户钱包上的应用程序向智能卡发送以下内容:</p><ul class=""><li id="cb65" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated">Si =秘密(智能卡)</li><li id="3ba3" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated">H =哈希(待签名的交易)</li></ul><p id="7296" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">智能卡现在计算与复合密钥相关联的比特币地址的值(P0+Pi)。卡返回的签名为:</p><ul class=""><li id="28c1" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated">(R，S) i—地址的复合ECDSA签名(P0+Pi)。</li></ul><p id="7357" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用程序将更改(如果有)设置为新地址P(i+1)。</p><p id="37eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P(硬币+1)的地址在智能卡上导出，并返回给应用程序。为了做到这一点，在应用程序上生成一个新的密码并发送给智能卡:</p><ul class=""><li id="7716" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated">P0 =秘密(智能卡)X G (G是ECDSA固化运算符)</li><li id="7e4a" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated">P(i+1) =秘密(钱包值+ 1) X G</li><li id="dedc" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated">P(硬币+1) = P0 + P(i+1)</li></ul><p id="4193" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">手机应用程序从来不需要将秘密发送到卡上，它会发送公钥。如果持卡人知道(这是一种可能的方法)(比如不仅使用了散列地址，还使用了密钥)，应用程序就可以进行计算。</p><p id="5f87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用智能卡和应用程序，您现在可以拥有一个需要智能卡签名的安全钱包，它也可以用来增强Handcash或Centbee等钱包。每次对消息进行签名时，都会安全地生成一个新密钥。</p><p id="b001" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用该卡，可以为每种设备和多种原因创建单独的钱包。它允许人们从Ledger等笨拙而陈旧的硬件设备中寻找所有的东西，并且具有更大的灵活性。该过程确保您只使用一次密钥；更重要的是，它可以让你以后证明一个关键，同时保持完全的隐私。</p><p id="0b26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每枚硬币在使用时都会被送到一个新的地址。每张都使用一次且仅使用一次，卡只需完成一个简单的操作，因为大部分交易构建都是通过手机或app设备完成的。</p><p id="6899" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以创建智能卡的备份并将其存储在保险箱中，以便进行恢复，并且只有当用户的生物特征(如用户的指纹)存在时，智能卡和应用程序才能一起工作。一张卡可以反复使用，永远不会暴露密钥，因为智能卡上的注册密钥永远不会用于发送和接收比特币。</p><p id="d5d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更重要的是，这种卡可以与下面详述的过程一起使用，安全地加密文件(也见上一篇文章),甚至对计算机进行认证，并保护远程系统的VPN。</p><h1 id="9e9a" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">个人设备安全-基础发明的细节</h1><p id="2ae0" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">本发明描述了一种对任何个人电子设备上的数据进行安全加密的新方法，所述个人电子设备包括(但不限于)PC、膝上型计算机和平板电脑。该方法采用了在两个节点之间共享秘密值的技术，如题为“确定两个节点的公共秘密”的nChain专利中所描述的</p><h2 id="b8e3" class="ln kk hi bd kl lo lp lq kp lr ls lt kt iq lu lv kx iu lw lx lb iy ly lz lf ma bi translated"><strong class="ak">问题描述</strong></h2><p id="27b6" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">笔记本电脑或个人电脑等个人设备上的数据加密旨在保护硬盘数据，以防设备丢失或被盗。现有的方法有许多缺点。例如，要解密硬盘，用户可能需要输入密码，如PIN或密码短语。但是，黑客可以很容易地破解短代码，例如通常为4-8个长字符的pin码，因为他们实际拥有该设备，并且有足够的时间来尝试常见的组合。密码要安全得多，但这取决于用户是否记住了一长串密码或一个长句子。一个更安全的过程包括使用密钥，例如插入USB驱动器。然而，即使这样的方法也有安全漏洞。尽管USB驱动器和设备之间有直接的物理连接，但由于传输过程中产生的电磁信号(例如通过功率分析)，传输的秘密仍可能被截获[1]。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mb"><img src="../Images/e4c50eb9f266dd8d86f71b1523a16ba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*5QO4-A5TwwR_maa9"/></div></figure><p id="366d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本方法通过使个人设备能够基于认证用户仅传输非秘密信息来<em class="jd">计算</em>秘密，从而克服了这种性质的问题。</p><h2 id="908b" class="ln kk hi bd kl lo lp lq kp lr ls lt kt iq lu lv kx iu lw lx lb iy ly lz lf ma bi translated"><strong class="ak">词汇</strong></h2><p id="6f29" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">DCS——专利名称为“T4 ”,确定两个节点的共同秘密</p><p id="134b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">PED —要加密的个人电子设备(如笔记本电脑、PC等)。)</p><p id="b7eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">钥匙圈—包含用户主密钥的设备(例如，智能手机、USB key等。)</p><p id="34cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用户——PED的授权用户和钥匙圈的所有者</p><p id="71b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">软件——大写时,“软件”是指在PED上运行的应用程序，它执行椭圆曲线计算并与密钥环通信。</p><p id="c4d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">App——大写时,“App”指的是在钥匙圈上运行的应用程序，它执行椭圆曲线计算并与PED通信。</p><p id="430d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ECC —“椭圆曲线加密”</p><p id="5140" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">会话—PED未加密且被用户使用的时间段。会话以用户认证开始，随后是PED解密，以PED加密结束。</p><p id="d21a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">周期—一整轮加密和解密事件(其间PED处于空闲状态)</p><p id="ff76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih mc">本发明的关键要素如下:</strong></p><p id="2aa7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.加密/解密密钥是全强度加密密钥(例如AES256)，其本身从不在用户和设备之间传递。相反，在对用户的密钥环进行身份验证后，需要时会重新计算密钥。加密密钥仅用于一个加密/解密周期。为每个周期计算一个新密钥。</p><p id="ee80" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.该方法使用在nChains专利“<a class="ae lm" href="https://medium.com/r/?url=https%3A%2F%2Fpatentimages.storage.googleapis.com%2Fe9%2Fd4%2F1a%2F644d344019a178%2FEP3268914B1.pdf" rel="noopener">确定两个节点的公共秘密</a>”中描述的秘密密钥共享协议(以下缩写为DCS —“确定公共秘密”)。</p><h1 id="6715" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><strong class="ak">除外责任</strong></h1><p id="6f06" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">1.实际的加密/解密过程采用现有的标准，这里不再描述。</p><p id="8371" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.此处不描述处理通信中断(如电缆断开)的协议。</p><h1 id="28e8" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><strong class="ak">技术描述</strong></h1><p id="7da8" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">在下面的描述中，参考了DCS。为保持一致，此处使用了与DCS中相同的术语，如下所示:</p><ul class=""><li id="7c6e" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated">PED(“服务器”)主私钥=虚拟机(由PED保密)</li><li id="bd9a" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated">PED(“服务器”)主公钥= PMS(非秘密)</li><li id="4233" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated">密匙环(“客户端”)主私钥= VMC(由密匙环保密)</li><li id="ea74" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated">密钥环(“客户端”)主公钥= PMC(非秘密)</li></ul><p id="1ee3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该描述是通过假设PED是运行该软件的膝上型电脑，而钥匙圈是运行该应用的智能手机的例子来进行的。</p><h1 id="e3ec" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><em class="md">初始化(参考DCS注册’)</em></h1><p id="de66" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">初始化阶段从一台完全未加密的笔记本电脑开始，软件已下载并安装到该笔记本电脑上(安装到一个保持未加密的分区中)。该软件的兼容智能手机应用版本已经安装在智能手机上——“兼容”意味着在两个设备上使用相同的ECC标准(例如secp256k1 ),具有包括生成器G在内的公共参数集，并且每个设备上的软件使用本文所述的公共协议。ECC参数永久存储在每个设备上(不需要保持安全)。</p><p id="1d92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1)笔记本电脑和智能手机已连接。这种连接是通过电缆或蓝牙等无线协议实现的。笔记本电脑软件与智能手机应用程序建立联系，并通过交换适当的信号来验证软件版本是否兼容和同步。</p><p id="ef5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a.注意:所有现有的安全措施都被认为是有效的。即，智能手机已经被用户的安全码解锁，并且用户已经以通常的方式用密码登录到膝上型电脑。</p><p id="3631" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2)笔记本电脑软件和智能手机应用程序都基于g独立生成自己的公钥/私钥对。最初生成的密钥是主密钥。私钥(虚拟机和VMC)都安全地保存在相关的自有设备上。公钥(PMS和PMC)各自被传输到另一个设备。每个设备永久保存三个主密钥(它们自己的私钥/公钥+其他设备的公钥)。</p><p id="d544" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3)膝上型电脑创建新消息‘Mn’(n = new)，并使用标准算法创建消息的散列，得到256位整数:</p><ul class=""><li id="e93a" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated">Message = Mn(随机生成数的哈希160)<a class="ae lm" href="#_ftn1" rel="noopener ugc nofollow">【1】</a></li><li id="9844" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated">消息哈希= SHA-256(Mn)</li></ul><p id="2b58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">初始化持续到第一加密阶段结束。从那时起，每个会话由开始的解密阶段和结束的加密阶段组成。</p><h1 id="2ad7" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><em class="md">加密</em></h1><p id="1b2d" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">4)膝上型电脑软件使用Mn来重新计算它自己的下一代私钥/公钥对和智能手机的新公钥:</p><ul class=""><li id="0c1d" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated">笔记本电脑的新私钥= VnS = VMS + SHA-256(Mn)</li><li id="b54f" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated">笔记本电脑的新公钥= PnS = PMS + SHA-256(Mn) X G</li><li id="1fd1" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated">智能手机的新公钥= PnC = PMC + SHA-256(Mn) X G</li></ul><p id="c584" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5)软件现在可以计算一个(新的)秘密序列号:</p><p id="b674" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih mc">软件</strong>计算Sn = VnS X PnC</p><p id="f4c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(注意:App也可以计算秘密，如在DCS中，但是在本发明中，仅需要软件来导出该值)。</p><p id="9e34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6)在本示例中，秘密Sn不被用作加密密钥，尽管在一些变型中它可以被用作加密密钥(参见变型1)。在本例中，膝上型电脑的序列号被编码在加密密钥中，以确保它仅特定于膝上型电脑。加密密钥E的计算如下:</p><p id="26d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">E = SHA256(SHA256(盐+序列号)+序列号)</p><p id="ae8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在哪里</p><p id="99da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Salt = Mn(有关加密Salt的解释，请参见[2])</p><p id="51ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7)作为注销和关机过程的一部分，软件对磁盘进行加密。加密密钥E没有存储在任何地方，并且消息Mn没有存储在膝上型电脑上。消息Mn被安全地存储在智能手机上，用于在下一次会话中解密硬盘驱动器。</p><h1 id="5630" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><em class="md">解密</em></h1><p id="23aa" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">8)笔记本电脑和智能手机已连接。该连接通过电缆或无线协议(如蓝牙)来完成。笔记本电脑软件与智能手机应用程序建立联系，并通过交换适当的信号来验证软件版本是否兼容和同步。</p><p id="b30c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(注意:该步骤与初始化阶段的步骤1相同)</p><p id="9022" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">9)对于应用程序验证，笔记本电脑会创建一条新消息“Mn”Mn将用于当前解密阶段的认证，也将用于后续加密阶段的加密。该值是新创建的，不同于加密阶段结束时存储在智能手机上的先前创建的消息。为了区分这两者，先前存储的消息将被称为Mo (o = 'old ')。笔记本电脑将Mn发送到智能手机，并使用标准算法创建消息的哈希，得到256位整数:</p><ul class=""><li id="0bd3" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated">Message = Mn(随机生成的数字的哈希160)</li><li id="362f" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated">消息哈希= SHA-256(Mn)</li></ul><p id="ffb2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">10)智能手机应用首先根据Mn的值计算新一代的私钥/公钥对(详情请参考DCS):</p><ul class=""><li id="b385" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated">智能手机的新私钥= VnC = VMC + SHA-256(Mn)</li><li id="8bcb" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated">智能手机的新公钥= PnC = PMC + SHA-256(Mn) X G</li></ul><p id="ccb3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">11)应用程序然后用其新的私钥签署Mn，并发送回膝上型电脑软件:</p><ul class=""><li id="d944" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated">签名消息= Sig-VnC <mn/></li></ul><p id="7f0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">12)与在DCS中一样，软件通过验证签名消息来验证应用程序。它通过使用(10)中的公式独立计算应用的新公钥(PnC ),然后在Sig-VnC <mn>和PnC之间执行标准ECDSA检查。</mn></p><p id="82f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">13)建立了应用程序的凭证后，软件现在向应用程序发送请求，以获取“旧”消息Mo，该消息Mo在之前的加密阶段被安全地专门存储在智能手机上。为了增加安全性，应用程序使用新一代私钥对Mo进行签名，并将签名后的消息发送回软件:Sig-VnC <mo>。软件可以验证签名，并以通常的方式检索Mo。</mo></p><p id="efeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">14)消息Mo与膝上型电脑和智能手机的前一代公钥/私钥对相关联，即在前一加密周期中生成的密钥。膝上型电脑现在能够重新计算这些密钥，因此也能够重新计算秘密S和加密密钥。</p><p id="19fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">15)重新计算的加密密钥用于解密磁盘，用户现在可以照常操作膝上型电脑。新创建的消息Mn在会话期间被保留在存储器中，当用户注销、重启或关机(等等)时，该会话将以加密阶段结束。).</p><h2 id="2aca" class="ln kk hi bd kl lo lp lq kp lr ls lt kt iq lu lv kx iu lw lx lb iy ly lz lf ma bi translated"><em class="md">变化1:加密密钥=秘密密钥S </em></h2><p id="5ed6" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">在某些情况下，将序列号嵌入加密密钥可能没有必要或不可行，例如，PED是一种没有可访问序列号的设备类型。在这种情况下，秘密Sn本身可以用作加密密钥。</p><h2 id="d384" class="ln kk hi bd kl lo lp lq kp lr ls lt kt iq lu lv kx iu lw lx lb iy ly lz lf ma bi translated"><em class="md">变化2:文件夹/文件加密</em></h2><p id="9ef0" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">一种变体是对单个文件或文件夹进行加密。PED和密匙环应用程序可以设计为提示用户加密哪些文件/文件夹。对于每个单独的文件/文件夹，将生成新的salt(消息Mn ),从该salt中将导出文件/文件夹特定的加密密钥。在这种情况下，钥匙圈应用程序将安全地存储一个将唯一的文件/文件夹ID链接到相关消息的表。至于磁盘加密，加密密钥仅在一个周期内有效——因为对于每个新周期都会计算一个新的加密密钥(即，在已经访问了文件/文件夹的每个会话之后，在表上替换相关的存储消息Mn)。</p><h1 id="09e8" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><strong class="ak">参考文献</strong></h1><p id="951f" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">[1]<a class="ae lm" href="https://theintercept.com/document/2015/03/10/tpm-vulnerabilities-power-analysis-exposed-exploit-bitlocker/" rel="noopener ugc nofollow" target="_blank">https://the intercept . com/document/2015/03/10/TPM-vulnerabilities-power-analysis-exposed-exploit-bitlocker/</a></p><p id="55c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[2]<a class="ae lm" href="https://en.wikipedia.org/wiki/Salt_(cryptography)" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Salt _(密码术)</a></p><p id="eebb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[3] <em class="jd">使用椭圆曲线密码进行秘密共享的个人设备安全:</em><a class="ae lm" href="https://patentimages.storage.googleapis.com/4c/c5/d2/48ad44c210de89/EP3257006B1.pdf" rel="noopener ugc nofollow" target="_blank">https://patent images . storage . Google APIs . com/4c/C5/D2/48 ad 44 c 210 de 89/EP 3257006 b 1 . pdf</a></p><h2 id="3401" class="ln kk hi bd kl lo lp lq kp lr ls lt kt iq lu lv kx iu lw lx lb iy ly lz lf ma bi translated">脚注</h2><p id="8896" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated"><a class="ae lm" href="#_ftnref1" rel="noopener ugc nofollow">【1】</a>为了生成加密密钥，消息的选择是任意的，但是需要在每个周期都是新的。通过散列将消息减少到160位，以保持消息长度较短。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><a href="https://medium.com/swlh"><div class="er es me"><img src="../Images/308a8d84fb9b2fab43d66c117fcc4bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YqDjlKFwScoQYQ62DWEdig.png"/></div></a></figure><h2 id="c148" class="ln kk hi bd kl lo lp lq kp lr ls lt kt iq lu lv kx iu lw lx lb iy ly lz lf ma bi translated">这篇文章发表在<a class="ae lm" href="https://medium.com/swlh" rel="noopener"> The Startup </a>上，这是Medium最大的创业刊物，有+411，714人关注。</h2><h2 id="869c" class="ln kk hi bd kl lo lp lq kp lr ls lt kt iq lu lv kx iu lw lx lb iy ly lz lf ma bi translated">订阅接收<a class="ae lm" href="http://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="jf jg jh ji fd jj er es paragraph-image"><a href="https://medium.com/swlh"><div class="er es me"><img src="../Images/b0164736ea17a63403e660de5dedf91a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ouK9XR4xuNWtCes-TIUNAw.png"/></div></a></figure></div></div>    
</body>
</html>