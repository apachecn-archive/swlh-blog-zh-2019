<html>
<head>
<title>Framework Fatigue? Webcomponents to the rescue!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">框架疲劳？Webcomponents来拯救我们！</h1>
<blockquote>原文：<a href="https://medium.com/swlh/framework-fatigue-webcomponents-to-the-rescue-5e36869a1bc0?source=collection_archive---------50-----------------------#2019-06-26">https://medium.com/swlh/framework-fatigue-webcomponents-to-the-rescue-5e36869a1bc0?source=collection_archive---------50-----------------------#2019-06-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/ce696bc2d4c505df1f86937d7a3e666f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*wdrfwR-FIkbOK6X2J5nc1g.png"/></div></figure><p id="6679" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">只需前往npm，输入类似“datepicker”的内容。您将看到类似这样的内容:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="46b8" class="jt ju hi jp b fi jv jw l jx jy">react-datepicker<br/>angular-datepicker<br/>vue-datepicker<br/>vue-<strong class="jp jz">the-very-last</strong>-datepicker<br/>vue-<strong class="jp jz">the-very-last</strong>-datepicker-<strong class="jp jz">v2<br/>...</strong></span></pre><p id="d694" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">从Vue到Angular到React的每个框架都有一个日期选择器…这是Javascript世界中一个非常普遍的问题。</p><p id="c728" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">拥有一个<strong class="io jz">单独的</strong>日期选择器，可以用于所有的库或框架，这不是很好吗？</p><h2 id="0887" class="jt ju hi bd ka kb kc kd ke kf kg kh ki ix kj kk kl jb km kn ko jf kp kq kr ks bi translated">Web组件拯救世界！</h2><p id="1f72" class="pw-post-body-paragraph im in hi io b ip kt ir is it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj hb bi translated">web组件背后的技术允许您在不使用任何框架(！)，并在您的文档中使用它，就像任何其他HTML元素一样，如<code class="du ky kz la jp b">&lt;input&gt;</code>或<code class="du ky kz la jp b">&lt;button&gt;</code></p><p id="29c9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是一个很大的优势，特别是对于创建应该在使用不同框架的项目之间共享的元素，或者在不需要复杂框架的项目上，但是您仍然希望有一些结构。</p><h2 id="b54d" class="jt ju hi bd ka kb kc kd ke kf kg kh ki ix kj kk kl jb km kn ko jf kp kq kr ks bi translated">web组件的4个构造块</h2><p id="1ebe" class="pw-post-body-paragraph im in hi io b ip kt ir is it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj hb bi translated">Web组件是以下四种技术的组合:</p><ol class=""><li id="2b6a" class="lb lc hi io b ip iq it iu ix ld jb le jf lf jj lg lh li lj bi translated">HTML <code class="du ky kz la jp b">&lt;template&gt;</code>标签</li><li id="df0e" class="lb lc hi io b ip lk it ll ix lm jb ln jf lo jj lg lh li lj bi translated">自定义元素API</li><li id="25e8" class="lb lc hi io b ip lk it ll ix lm jb ln jf lo jj lg lh li lj bi translated">阴影Dom</li><li id="3d31" class="lb lc hi io b ip lk it ll ix lm jb ln jf lo jj lg lh li lj bi translated">ES模块</li></ol><p id="8d26" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们通过创建自己的web组件按钮来解释这四个构件。</p><p id="1860" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io jz"> &gt; &gt;此处查看出处和例子&gt;&gt;</strong><a class="ae lp" href="https://playcode.io/347575?tabs=my-button.js,preview,console" rel="noopener ugc nofollow" target="_blank"><strong class="io jz">https://playcode.io/347575?tabs=my-button.js，预览，控制台</strong> </a></p><p id="efeb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae lp" href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_templates_and_slots" rel="noopener ugc nofollow" target="_blank"> <strong class="io jz"> 1。模板</strong> </a> <strong class="io jz"> : </strong>一个<code class="du ky kz la jp b">&lt;template&gt;</code>的内容是浏览器渲染的<em class="lq">而不是</em>，但是你仍然可以在Javascript中引用它。这非常适合您希望在不同位置多次使用的内容，并且非常适合在web组件中使用。</p><p id="2c1c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们用下面的模板创建一个简单的HTML文档<code class="du ky kz la jp b">index.html</code>，里面有一个简单的按钮:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="ac43" class="jt ju hi jp b fi jv jw l jx jy">&lt;html&gt;<br/>&lt;head&gt;&lt;/head&gt;<br/>&lt;body&gt;</span><span id="141f" class="jt ju hi jp b fi lr jw l jx jy"><strong class="jp jz">&lt;template id="myButton"&gt;<br/> &lt;style&gt;<br/>      div {  <br/>           background: red; <br/>           color: white; <br/>           padding: 1em; <br/>           text-align: center; <br/>     } <br/>&lt;/style&gt;<br/> &lt;div&gt;Click me&lt;/div&gt;<br/>&lt;/template&gt;</strong></span><span id="96e6" class="jt ju hi jp b fi lr jw l jx jy">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="541c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果您在浏览器中打开该文件，应该不会像预期的那样呈现任何内容。</p><p id="9f5c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae lp" href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements" rel="noopener ugc nofollow" target="_blank">2<strong class="io jz">2。自定义元素API: </strong> </a>自定义元素API允许您将web组件所需的所有代码捆绑在一个类中，并为您的元素定义一个标记名。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="904b" class="jt ju hi jp b fi jv jw l jx jy">class <strong class="jp jz">MyButton</strong> <strong class="jp jz">extends HTMLElement</strong> {</span><span id="1ca1" class="jt ju hi jp b fi lr jw l jx jy">constructor() {<br/>   super.constructor();<br/>}</span><span id="bd40" class="jt ju hi jp b fi lr jw l jx jy">}<br/><strong class="jp jz">customElements.define('my-button', MyButton);</strong></span></pre><p id="c12d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">用<code class="du ky kz la jp b">customElements.define</code>我们定义元素的名称和相应的类。该名称需要有一个<code class="du ky kz la jp b">-</code>符号，并且该类必须从HTMLElement扩展。</p><p id="7e06" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们不是将模板标签直接放在主文档中，而是将它添加到新创建的javascript文件中，如下所示:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="c20c" class="jt ju hi jp b fi jv jw l jx jy"><strong class="jp jz">const template = document.createElement('template'); <br/>template.innerHTML = `<br/></strong><strong class="jp jz"> &lt;style&gt;<br/>     div {  <br/>           background: red; <br/>           color: white; <br/>           padding: 1em; <br/>           text-align: center; <br/>     }<br/> &lt;/style&gt;<br/> &lt;div&gt;Click me&lt;/div&gt;</strong><strong class="jp jz"><br/>`;</strong></span><span id="d812" class="jt ju hi jp b fi lr jw l jx jy">class MyButton extends HTMLElement {</span><span id="d026" class="jt ju hi jp b fi lr jw l jx jy">constructor() {<br/>   super.constructor();<br/>}</span><span id="832f" class="jt ju hi jp b fi lr jw l jx jy">}<br/>customElements.define('my-button', MyButton);</span></pre><p id="6310" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这样，我们可以在一个模块中拥有一切。下一步，我们将模板的内容添加到元素中。为此，我们先来看看影子dom。</p><p id="5a23" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae lp" href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM" rel="noopener ugc nofollow" target="_blank"> <strong class="io jz"> 3。阴影Dom </strong> </a> <strong class="io jz"> </strong>阴影Dom允许你封装你的样式和标记结构。这使得web组件的代码与文档的其余部分分离开来。没有框架。只是纯原生浏览器技术。</p><p id="522a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这太棒了。</p><p id="04b9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你需要显式地给你的元素附加一个阴影dom，如下所示:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="fffa" class="jt ju hi jp b fi jv jw l jx jy">const template = document.createElement('template'); <br/>template.innerHTML = `<br/> &lt;style&gt;<br/><strong class="jp jz">     </strong>div {  <br/>           background: red; <br/>           color: white; <br/>           padding: 1em; <br/>           text-align: center; <br/>     }<br/> &lt;/style&gt;<br/> &lt;div&gt;Click me&lt;/div&gt;<br/>`;</span><span id="a7e2" class="jt ju hi jp b fi lr jw l jx jy">class MyButton extends HTMLElement {</span><span id="fd55" class="jt ju hi jp b fi lr jw l jx jy">constructor() {<br/>   super.constructor();<br/>   <strong class="jp jz">this.attachShadow({mode: 'open'}); // &lt;--- attaching shadow dom!</strong><br/>}</span><span id="55f4" class="jt ju hi jp b fi lr jw l jx jy">}<br/>customElements.define('my-button', MyButton);</span></pre><p id="d279" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们将模板内容添加到我们的影子dom中:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="aa17" class="jt ju hi jp b fi jv jw l jx jy">const template = document.createElement('template'); <br/>template.innerHTML = `<br/> &lt;style&gt;<br/><strong class="jp jz">     </strong>div {  <br/>           background: red; <br/>           color: white; <br/>           padding: 1em; <br/>           text-align: center; <br/>     }<br/> &lt;/style&gt;<br/> &lt;div&gt;Click me&lt;/div&gt;<br/>`;</span><span id="eba3" class="jt ju hi jp b fi lr jw l jx jy">class MyButton extends HTMLElement {</span><span id="430c" class="jt ju hi jp b fi lr jw l jx jy">constructor() {<br/>   super.constructor();<br/>   this.attachShadow({mode: 'open'});</span><span id="7d64" class="jt ju hi jp b fi lr jw l jx jy"><strong class="jp jz">   this.shadowRoot.appendChild(template.content.cloneNode(true));</strong><br/>}</span><span id="d79b" class="jt ju hi jp b fi lr jw l jx jy">}<br/>customElements.define('my-button', MyButton);</span></pre><p id="1f21" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如你所见，我们使用<code class="du ky kz la jp b">template.content.cloneNode(true)</code>来克隆模板的内容，然后将它附加到我们的影子dom。</p><p id="a290" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">标记和样式只在我们的组件中可用。</p><p id="30e6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们来谈谈如何在主文档中使用web组件按钮。</p><p id="1277" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io jz"> 4。ES模块</strong>您可以导入您的web组件以在其他web组件中使用它，或者通过使用<code class="du ky kz la jp b">&lt;script src="my-button.js type="module"&gt;&lt;/script&gt;</code>简单地从上面导入它到您的主文档<code class="du ky kz la jp b">index.html</code>中:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="af9f" class="jt ju hi jp b fi jv jw l jx jy">&lt;html&gt;<br/>  &lt;head&gt;<br/>    <strong class="jp jz">&lt;script src="my-button.js" type="module"&gt;&lt;/script&gt;</strong><br/>  &lt;/head&gt;<br/>&lt;body&gt;</span><span id="bc94" class="jt ju hi jp b fi lr jw l jx jy"><strong class="jp jz">&lt;my-button onclick="alert('hi')"&gt;&lt;/mybutton&gt;</strong></span><span id="af68" class="jt ju hi jp b fi lr jw l jx jy">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="bb57" class="jt ju hi bd ka kb kc kd ke kf kg kh ki ix kj kk kl jb km kn ko jf kp kq kr ks bi translated">狭槽</h2><p id="03d9" class="pw-post-body-paragraph im in hi io b ip kt ir is it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj hb bi translated">如果我们想让用户在按钮上添加自己的自定义文本，而不是固定的文本“点击我”呢？如下例所示:</p><p id="bdd8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du ky kz la jp b">&lt;my-button&gt;You can click me, sir.&lt;/my-button&gt;</code></p><p id="6619" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这就是老虎机的用武之地:</p><blockquote class="ls lt lu"><p id="21a0" class="im in lq io b ip iq ir is it iu iv iw lv iy iz ja lw jc jd je lx jg jh ji jj hb bi translated"><strong class="io jz"> HTML </strong> <code class="du ky kz la jp b"><strong class="io jz"><em class="hi">&lt;slot&gt;</em></strong></code> <strong class="io jz">元素</strong>—<a class="ae lp" href="https://developer.mozilla.org/en-US/docs/Web/Web_Components" rel="noopener ugc nofollow" target="_blank">Web组件</a>技术套件的一部分——是Web组件内的占位符，您可以用自己的标记填充它[…]</p><p id="d8d2" class="im in lq io b ip iq ir is it iu iv iw lv iy iz ja lw jc jd je lx jg jh ji jj hb bi translated"><a class="ae lp" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/slot" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/HTML/Element/slot</a></p></blockquote><p id="aae1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以基本上我们可以将<code class="du ky kz la jp b">&lt;slot&gt;&lt;/slot&gt;</code>添加到模板中我们希望自定义文本出现的位置。</p><p id="9370" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在我们的例子中，我们用<code class="du ky kz la jp b">&lt;slot&gt;&lt;/slot&gt;</code>替换“点击我”文本:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="9198" class="jt ju hi jp b fi jv jw l jx jy">const template = document.createElement('template'); <br/>template.innerHTML = `<br/> &lt;style&gt;<br/><strong class="jp jz">     </strong>div {  <br/>           background: red; <br/>           color: white; <br/>           padding: 1em; <br/>           text-align: center; <br/>     }<br/> &lt;/style&gt;</span><span id="290d" class="jt ju hi jp b fi lr jw l jx jy"><strong class="jp jz">&lt;!-- we've replaced the text with &lt;slot&gt;--&gt;<br/>&lt;div&gt;&lt;slot&gt;&lt;/slot&gt;&lt;/div&gt; </strong><strong class="jp jz"><br/></strong>`;</span><span id="4575" class="jt ju hi jp b fi lr jw l jx jy">class MyButton extends HTMLElement {</span><span id="ea1a" class="jt ju hi jp b fi lr jw l jx jy">constructor() {<br/>   super.constructor();<br/>   this.attachShadow({mode: 'open'});</span><span id="566d" class="jt ju hi jp b fi lr jw l jx jy">this.shadowRoot.appendChild(template.content.cloneNode(true));<br/>}</span><span id="7391" class="jt ju hi jp b fi lr jw l jx jy">}<br/>customElements.define('my-button', MyButton);</span></pre><p id="7b41" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们可以向按钮添加一些自定义文本:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="8d1e" class="jt ju hi jp b fi jv jw l jx jy">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;script src="my-button.js" type="module"&gt;&lt;/script&gt;<br/>    &lt;style&gt;my-button { margin: 1em; }&lt;/style&gt;<br/>  &lt;/head&gt;<br/>&lt;body&gt;<br/>  <br/><strong class="jp jz">&lt;my-button onclick="alert('hi');"&gt;You can click me, sir&lt;/my-button&gt;<br/>&lt;my-button onclick="alert('hello');"&gt;Banana&lt;/my-button&gt;<br/>&lt;my-button onclick="alert('hey');"&gt;Okaaay!&lt;/my-button&gt;</strong></span><span id="affb" class="jt ju hi jp b fi lr jw l jx jy">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="c017" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我还添加了一些按钮，并点击带有警告框的事件来测试这些按钮。</p><p id="fc7d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您已经创建了自己的第一个web组件按钮！</p><p id="655f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我为你骄傲，儿子。</p><p id="b86d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这里看看完整的源代码和演示:<a class="ae lp" href="https://playcode.io/347575?tabs=my-button.js,preview,console" rel="noopener ugc nofollow" target="_blank">https://playcode.io/347575?tabs=my-button.js，预览，控制台</a></p></div></div>    
</body>
</html>